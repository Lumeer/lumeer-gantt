!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).Gantt={})}(this,(function(t){"use strict";function e(t){return null==t}function s(t){return!e(t)}function i(t){return[...t||[]]}function n(t){return[...t||[]].map(t=>[...t||[]])}function r(t,e){const s=e||[];return(t||[]).filter(t=>!s.includes(t))}function a(t){return Array.isArray(t)}function o(t){return!("boolean"==typeof t||t&&""===String(t).trim())&&!isNaN(h(t))}function h(t){const e=t&&t.toString().replace(/\s/g,"").replace(",",".");return Number(e)}function d(t){return Array.from(new Set(t))}function l(t,e){const s=[...t||[]];for(let t=s.length;t<e;t++)s[t]=null;return s}function c(t,e){return e?e.matches&&e.matches(t)?e:c(t,e.parentNode):null}function u(t,e,s,i){const n=document.createElementNS("http://www.w3.org/2000/svg",t);return i&&(n.innerHTML=i),Object.entries(e||{}).forEach(([t,e])=>n.setAttribute(t,e)),s&&s.appendChild(n),n}function g(t,e){Object.keys(e||{}).forEach(s=>m(t,s,e[s]))}function m(t,e,s){var i;null===(i=t)||void 0===i||i.setAttribute(e,s)}function f(t,e,s){var i;if(null===(i=t)||void 0===i?void 0:i.hasAttribute(e)){const i=+t.getAttribute(e);m(t,e,i+s)}}function p(t){t&&m(t,"display","visible")}function v(t){t&&m(t,"display","none")}function w(t){var e;return+(null===(e=t)||void 0===e?void 0:e.getAttribute("x"))}function y(t){var e;return+(null===(e=t)||void 0===e?void 0:e.getAttribute("width"))}function _(t){return w(t)+y(t)}function k(t,e,s,i){const n=function(t,e,s,i,n="0.4s",r="0.1s"){const a=t.querySelector("animate");if(a)return g(a,{attributeName:e,from:s,to:i,dur:n,begin:"click + "+r}),t;const o=u("animate",{attributeName:e,from:s,to:i,dur:n,begin:r,calcMode:"spline",values:s+";"+i,keyTimes:"0; 1",keySplines:(h="ease-out",{ease:".25 .1 .25 1",linear:"0 0 1 1","ease-in":".42 0 1 1","ease-out":"0 0 .58 1","ease-in-out":".42 0 .58 1"}[h])});var h;return t.appendChild(o),t}(t,e,s,i);if(n===t){const t=document.createEvent("HTMLEvents");t.initEvent("click",!0,!0),t.eventName="click",n.dispatchEvent(t)}}function D(t=3){return{width:8.6*t,height:10.8*t}}function S(t){return{x:Math.max(t.offsetX||0,t.layerX||0),y:Math.max(t.offsetY||0,t.layerY||0)}}var M;(M=t.GanttMode||(t.GanttMode={})).QuarterDay="Quarter Day",M.HalfDay="Half Day",M.Day="Day",M.Week="Week",M.Month="Month",M.Year="Year";const b={headerHeight:50,columnWidth:30,viewModes:[t.GanttMode.QuarterDay,t.GanttMode.HalfDay,t.GanttMode.Day,t.GanttMode.Week,t.GanttMode.Month,t.GanttMode.Year],barHeight:20,barCornerRadius:3,arrowCurve:5,padding:20,viewMode:t.GanttMode.Day,dateFormat:"YYYY-MM-DD HH",language:"en",maxInitialSwimlaneWidth:200,avatarPadding:5,avatarSize:24,checkboxSize:16,textBackgroundPadding:8,lockResize:!0,createTasks:!0,resizeSwimlanes:!0,resizeTaskLeft:!0,resizeTaskRight:!0,resizeProgress:!0,dragTaskSwimlanes:!0};"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function E(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function x(t,e){return t(e={exports:{}},e.exports),e.exports}var L,Y,T=x((function(t,e){t.exports=function(){var e,s;function i(){return e.apply(null,arguments)}function n(t){return t instanceof Array||"[object Array]"===Object.prototype.toString.call(t)}function r(t){return null!=t&&"[object Object]"===Object.prototype.toString.call(t)}function a(t){return void 0===t}function o(t){return"number"==typeof t||"[object Number]"===Object.prototype.toString.call(t)}function h(t){return t instanceof Date||"[object Date]"===Object.prototype.toString.call(t)}function d(t,e){var s,i=[];for(s=0;s<t.length;++s)i.push(e(t[s],s));return i}function l(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function c(t,e){for(var s in e)l(e,s)&&(t[s]=e[s]);return l(e,"toString")&&(t.toString=e.toString),l(e,"valueOf")&&(t.valueOf=e.valueOf),t}function u(t,e,s,i){return Me(t,e,s,i,!0).utc()}function g(t){return null==t._pf&&(t._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}),t._pf}function m(t){if(null==t._isValid){var e=g(t),i=s.call(e.parsedDateParts,(function(t){return null!=t})),n=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&i);if(t._strict&&(n=n&&0===e.charsLeftOver&&0===e.unusedTokens.length&&void 0===e.bigHour),null!=Object.isFrozen&&Object.isFrozen(t))return n;t._isValid=n}return t._isValid}function f(t){var e=u(NaN);return null!=t?c(g(e),t):g(e).userInvalidated=!0,e}s=Array.prototype.some?Array.prototype.some:function(t){for(var e=Object(this),s=e.length>>>0,i=0;i<s;i++)if(i in e&&t.call(this,e[i],i,e))return!0;return!1};var p=i.momentProperties=[];function v(t,e){var s,i,n;if(a(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),a(e._i)||(t._i=e._i),a(e._f)||(t._f=e._f),a(e._l)||(t._l=e._l),a(e._strict)||(t._strict=e._strict),a(e._tzm)||(t._tzm=e._tzm),a(e._isUTC)||(t._isUTC=e._isUTC),a(e._offset)||(t._offset=e._offset),a(e._pf)||(t._pf=g(e)),a(e._locale)||(t._locale=e._locale),p.length>0)for(s=0;s<p.length;s++)a(n=e[i=p[s]])||(t[i]=n);return t}var w=!1;function y(t){v(this,t),this._d=new Date(null!=t._d?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===w&&(w=!0,i.updateOffset(this),w=!1)}function _(t){return t instanceof y||null!=t&&null!=t._isAMomentObject}function k(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function D(t){var e=+t,s=0;return 0!==e&&isFinite(e)&&(s=k(e)),s}function S(t,e,s){var i,n=Math.min(t.length,e.length),r=Math.abs(t.length-e.length),a=0;for(i=0;i<n;i++)(s&&t[i]!==e[i]||!s&&D(t[i])!==D(e[i]))&&a++;return a+r}function M(t){!1===i.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+t)}function b(t,e){var s=!0;return c((function(){if(null!=i.deprecationHandler&&i.deprecationHandler(null,t),s){for(var n,r=[],a=0;a<arguments.length;a++){if(n="","object"==typeof arguments[a]){for(var o in n+="\n["+a+"] ",arguments[0])n+=o+": "+arguments[0][o]+", ";n=n.slice(0,-2)}else n=arguments[a];r.push(n)}M(t+"\nArguments: "+Array.prototype.slice.call(r).join("")+"\n"+(new Error).stack),s=!1}return e.apply(this,arguments)}),e)}var x,L={};function Y(t,e){null!=i.deprecationHandler&&i.deprecationHandler(t,e),L[t]||(M(e),L[t]=!0)}function T(t){return t instanceof Function||"[object Function]"===Object.prototype.toString.call(t)}function P(t,e){var s,i=c({},t);for(s in e)l(e,s)&&(r(t[s])&&r(e[s])?(i[s]={},c(i[s],t[s]),c(i[s],e[s])):null!=e[s]?i[s]=e[s]:delete i[s]);for(s in t)l(t,s)&&!l(e,s)&&r(t[s])&&(i[s]=c({},i[s]));return i}function C(t){null!=t&&this.set(t)}i.suppressDeprecationWarnings=!1,i.deprecationHandler=null,x=Object.keys?Object.keys:function(t){var e,s=[];for(e in t)l(t,e)&&s.push(e);return s};var H={};function O(t,e){var s=t.toLowerCase();H[s]=H[s+"s"]=H[e]=t}function W(t){return"string"==typeof t?H[t]||H[t.toLowerCase()]:void 0}function B(t){var e,s,i={};for(s in t)l(t,s)&&(e=W(s))&&(i[e]=t[s]);return i}var R={};function A(t,e){R[t]=e}function G(t,e,s){var i=""+Math.abs(t),n=e-i.length;return(t>=0?s?"+":"":"-")+Math.pow(10,Math.max(0,n)).toString().substr(1)+i}var z=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,F=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,j={},I={};function U(t,e,s,i){var n=i;"string"==typeof i&&(n=function(){return this[i]()}),t&&(I[t]=n),e&&(I[e[0]]=function(){return G(n.apply(this,arguments),e[1],e[2])}),s&&(I[s]=function(){return this.localeData().ordinal(n.apply(this,arguments),t)})}function N(t,e){return t.isValid()?(e=V(e,t.localeData()),j[e]=j[e]||function(t){var e,s,i,n=t.match(z);for(e=0,s=n.length;e<s;e++)I[n[e]]?n[e]=I[n[e]]:n[e]=(i=n[e]).match(/\[[\s\S]/)?i.replace(/^\[|\]$/g,""):i.replace(/\\/g,"");return function(e){var i,r="";for(i=0;i<s;i++)r+=T(n[i])?n[i].call(e,t):n[i];return r}}(e),j[e](t)):t.localeData().invalidDate()}function V(t,e){var s=5;function i(t){return e.longDateFormat(t)||t}for(F.lastIndex=0;s>=0&&F.test(t);)t=t.replace(F,i),F.lastIndex=0,s-=1;return t}var $=/\d/,X=/\d\d/,Z=/\d{3}/,K=/\d{4}/,J=/[+-]?\d{6}/,q=/\d\d?/,Q=/\d\d\d\d?/,tt=/\d\d\d\d\d\d?/,et=/\d{1,3}/,st=/\d{1,4}/,it=/[+-]?\d{1,6}/,nt=/\d+/,rt=/[+-]?\d+/,at=/Z|[+-]\d\d:?\d\d/gi,ot=/Z|[+-]\d\d(?::?\d\d)?/gi,ht=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,dt={};function lt(t,e,s){dt[t]=T(e)?e:function(t,i){return t&&s?s:e}}function ct(t,e){return l(dt,t)?dt[t](e._strict,e._locale):new RegExp(ut(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(t,e,s,i,n){return e||s||i||n}))))}function ut(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var gt={};function mt(t,e){var s,i=e;for("string"==typeof t&&(t=[t]),o(e)&&(i=function(t,s){s[e]=D(t)}),s=0;s<t.length;s++)gt[t[s]]=i}function ft(t,e){mt(t,(function(t,s,i,n){i._w=i._w||{},e(t,i._w,i,n)}))}function pt(t,e,s){null!=e&&l(gt,t)&&gt[t](e,s._a,s,t)}function vt(t){return wt(t)?366:365}function wt(t){return t%4==0&&t%100!=0||t%400==0}U("Y",0,0,(function(){var t=this.year();return t<=9999?""+t:"+"+t})),U(0,["YY",2],0,(function(){return this.year()%100})),U(0,["YYYY",4],0,"year"),U(0,["YYYYY",5],0,"year"),U(0,["YYYYYY",6,!0],0,"year"),O("year","y"),A("year",1),lt("Y",rt),lt("YY",q,X),lt("YYYY",st,K),lt("YYYYY",it,J),lt("YYYYYY",it,J),mt(["YYYYY","YYYYYY"],0),mt("YYYY",(function(t,e){e[0]=2===t.length?i.parseTwoDigitYear(t):D(t)})),mt("YY",(function(t,e){e[0]=i.parseTwoDigitYear(t)})),mt("Y",(function(t,e){e[0]=parseInt(t,10)})),i.parseTwoDigitYear=function(t){return D(t)+(D(t)>68?1900:2e3)};var yt,_t=kt("FullYear",!0);function kt(t,e){return function(s){return null!=s?(St(this,t,s),i.updateOffset(this,e),this):Dt(this,t)}}function Dt(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function St(t,e,s){t.isValid()&&!isNaN(s)&&("FullYear"===e&&wt(t.year())&&1===t.month()&&29===t.date()?t._d["set"+(t._isUTC?"UTC":"")+e](s,t.month(),Mt(s,t.month())):t._d["set"+(t._isUTC?"UTC":"")+e](s))}function Mt(t,e){if(isNaN(t)||isNaN(e))return NaN;var s,i=(e%(s=12)+s)%s;return t+=(e-i)/12,1===i?wt(t)?29:28:31-i%7%2}yt=Array.prototype.indexOf?Array.prototype.indexOf:function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1},U("M",["MM",2],"Mo",(function(){return this.month()+1})),U("MMM",0,0,(function(t){return this.localeData().monthsShort(this,t)})),U("MMMM",0,0,(function(t){return this.localeData().months(this,t)})),O("month","M"),A("month",8),lt("M",q),lt("MM",q,X),lt("MMM",(function(t,e){return e.monthsShortRegex(t)})),lt("MMMM",(function(t,e){return e.monthsRegex(t)})),mt(["M","MM"],(function(t,e){e[1]=D(t)-1})),mt(["MMM","MMMM"],(function(t,e,s,i){var n=s._locale.monthsParse(t,i,s._strict);null!=n?e[1]=n:g(s).invalidMonth=t}));var bt=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Et="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),xt="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function Lt(t,e,s){var i,n,r,a=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)r=u([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(r,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(r,"").toLocaleLowerCase();return s?"MMM"===e?-1!==(n=yt.call(this._shortMonthsParse,a))?n:null:-1!==(n=yt.call(this._longMonthsParse,a))?n:null:"MMM"===e?-1!==(n=yt.call(this._shortMonthsParse,a))?n:-1!==(n=yt.call(this._longMonthsParse,a))?n:null:-1!==(n=yt.call(this._longMonthsParse,a))?n:-1!==(n=yt.call(this._shortMonthsParse,a))?n:null}function Yt(t,e){var s;if(!t.isValid())return t;if("string"==typeof e)if(/^\d+$/.test(e))e=D(e);else if(!o(e=t.localeData().monthsParse(e)))return t;return s=Math.min(t.date(),Mt(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,s),t}function Tt(t){return null!=t?(Yt(this,t),i.updateOffset(this,!0),this):Dt(this,"Month")}var Pt=ht,Ct=ht;function Ht(){function t(t,e){return e.length-t.length}var e,s,i=[],n=[],r=[];for(e=0;e<12;e++)s=u([2e3,e]),i.push(this.monthsShort(s,"")),n.push(this.months(s,"")),r.push(this.months(s,"")),r.push(this.monthsShort(s,""));for(i.sort(t),n.sort(t),r.sort(t),e=0;e<12;e++)i[e]=ut(i[e]),n[e]=ut(n[e]);for(e=0;e<24;e++)r[e]=ut(r[e]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+i.join("|")+")","i")}function Ot(t,e,s,i,n,r,a){var o;return t<100&&t>=0?(o=new Date(t+400,e,s,i,n,r,a),isFinite(o.getFullYear())&&o.setFullYear(t)):o=new Date(t,e,s,i,n,r,a),o}function Wt(t){var e;if(t<100&&t>=0){var s=Array.prototype.slice.call(arguments);s[0]=t+400,e=new Date(Date.UTC.apply(null,s)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)}else e=new Date(Date.UTC.apply(null,arguments));return e}function Bt(t,e,s){var i=7+e-s;return-(7+Wt(t,0,i).getUTCDay()-e)%7+i-1}function Rt(t,e,s,i,n){var r,a,o=1+7*(e-1)+(7+s-i)%7+Bt(t,i,n);return o<=0?a=vt(r=t-1)+o:o>vt(t)?(r=t+1,a=o-vt(t)):(r=t,a=o),{year:r,dayOfYear:a}}function At(t,e,s){var i,n,r=Bt(t.year(),e,s),a=Math.floor((t.dayOfYear()-r-1)/7)+1;return a<1?i=a+Gt(n=t.year()-1,e,s):a>Gt(t.year(),e,s)?(i=a-Gt(t.year(),e,s),n=t.year()+1):(n=t.year(),i=a),{week:i,year:n}}function Gt(t,e,s){var i=Bt(t,e,s),n=Bt(t+1,e,s);return(vt(t)-i+n)/7}function zt(t,e){return t.slice(e,7).concat(t.slice(0,e))}U("w",["ww",2],"wo","week"),U("W",["WW",2],"Wo","isoWeek"),O("week","w"),O("isoWeek","W"),A("week",5),A("isoWeek",5),lt("w",q),lt("ww",q,X),lt("W",q),lt("WW",q,X),ft(["w","ww","W","WW"],(function(t,e,s,i){e[i.substr(0,1)]=D(t)})),U("d",0,"do","day"),U("dd",0,0,(function(t){return this.localeData().weekdaysMin(this,t)})),U("ddd",0,0,(function(t){return this.localeData().weekdaysShort(this,t)})),U("dddd",0,0,(function(t){return this.localeData().weekdays(this,t)})),U("e",0,0,"weekday"),U("E",0,0,"isoWeekday"),O("day","d"),O("weekday","e"),O("isoWeekday","E"),A("day",11),A("weekday",11),A("isoWeekday",11),lt("d",q),lt("e",q),lt("E",q),lt("dd",(function(t,e){return e.weekdaysMinRegex(t)})),lt("ddd",(function(t,e){return e.weekdaysShortRegex(t)})),lt("dddd",(function(t,e){return e.weekdaysRegex(t)})),ft(["dd","ddd","dddd"],(function(t,e,s,i){var n=s._locale.weekdaysParse(t,i,s._strict);null!=n?e.d=n:g(s).invalidWeekday=t})),ft(["d","e","E"],(function(t,e,s,i){e[i]=D(t)}));var Ft="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),jt="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),It="Su_Mo_Tu_We_Th_Fr_Sa".split("_");function Ut(t,e,s){var i,n,r,a=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)r=u([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(r,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(r,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(r,"").toLocaleLowerCase();return s?"dddd"===e?-1!==(n=yt.call(this._weekdaysParse,a))?n:null:"ddd"===e?-1!==(n=yt.call(this._shortWeekdaysParse,a))?n:null:-1!==(n=yt.call(this._minWeekdaysParse,a))?n:null:"dddd"===e?-1!==(n=yt.call(this._weekdaysParse,a))?n:-1!==(n=yt.call(this._shortWeekdaysParse,a))?n:-1!==(n=yt.call(this._minWeekdaysParse,a))?n:null:"ddd"===e?-1!==(n=yt.call(this._shortWeekdaysParse,a))?n:-1!==(n=yt.call(this._weekdaysParse,a))?n:-1!==(n=yt.call(this._minWeekdaysParse,a))?n:null:-1!==(n=yt.call(this._minWeekdaysParse,a))?n:-1!==(n=yt.call(this._weekdaysParse,a))?n:-1!==(n=yt.call(this._shortWeekdaysParse,a))?n:null}var Nt=ht,Vt=ht,$t=ht;function Xt(){function t(t,e){return e.length-t.length}var e,s,i,n,r,a=[],o=[],h=[],d=[];for(e=0;e<7;e++)s=u([2e3,1]).day(e),i=this.weekdaysMin(s,""),n=this.weekdaysShort(s,""),r=this.weekdays(s,""),a.push(i),o.push(n),h.push(r),d.push(i),d.push(n),d.push(r);for(a.sort(t),o.sort(t),h.sort(t),d.sort(t),e=0;e<7;e++)o[e]=ut(o[e]),h[e]=ut(h[e]),d[e]=ut(d[e]);this._weekdaysRegex=new RegExp("^("+d.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+h.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function Zt(){return this.hours()%12||12}function Kt(t,e){U(t,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)}))}function Jt(t,e){return e._meridiemParse}U("H",["HH",2],0,"hour"),U("h",["hh",2],0,Zt),U("k",["kk",2],0,(function(){return this.hours()||24})),U("hmm",0,0,(function(){return""+Zt.apply(this)+G(this.minutes(),2)})),U("hmmss",0,0,(function(){return""+Zt.apply(this)+G(this.minutes(),2)+G(this.seconds(),2)})),U("Hmm",0,0,(function(){return""+this.hours()+G(this.minutes(),2)})),U("Hmmss",0,0,(function(){return""+this.hours()+G(this.minutes(),2)+G(this.seconds(),2)})),Kt("a",!0),Kt("A",!1),O("hour","h"),A("hour",13),lt("a",Jt),lt("A",Jt),lt("H",q),lt("h",q),lt("k",q),lt("HH",q,X),lt("hh",q,X),lt("kk",q,X),lt("hmm",Q),lt("hmmss",tt),lt("Hmm",Q),lt("Hmmss",tt),mt(["H","HH"],3),mt(["k","kk"],(function(t,e,s){var i=D(t);e[3]=24===i?0:i})),mt(["a","A"],(function(t,e,s){s._isPm=s._locale.isPM(t),s._meridiem=t})),mt(["h","hh"],(function(t,e,s){e[3]=D(t),g(s).bigHour=!0})),mt("hmm",(function(t,e,s){var i=t.length-2;e[3]=D(t.substr(0,i)),e[4]=D(t.substr(i)),g(s).bigHour=!0})),mt("hmmss",(function(t,e,s){var i=t.length-4,n=t.length-2;e[3]=D(t.substr(0,i)),e[4]=D(t.substr(i,2)),e[5]=D(t.substr(n)),g(s).bigHour=!0})),mt("Hmm",(function(t,e,s){var i=t.length-2;e[3]=D(t.substr(0,i)),e[4]=D(t.substr(i))})),mt("Hmmss",(function(t,e,s){var i=t.length-4,n=t.length-2;e[3]=D(t.substr(0,i)),e[4]=D(t.substr(i,2)),e[5]=D(t.substr(n))}));var qt,Qt=kt("Hours",!0),te={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:Et,monthsShort:xt,week:{dow:0,doy:6},weekdays:Ft,weekdaysMin:It,weekdaysShort:jt,meridiemParse:/[ap]\.?m?\.?/i},ee={},se={};function ie(t){return t?t.toLowerCase().replace("_","-"):t}function ne(e){var s=null;if(!ee[e]&&t&&t.exports)try{s=qt._abbr,E(),re(s)}catch(t){}return ee[e]}function re(t,e){var s;return t&&((s=a(e)?oe(t):ae(t,e))?qt=s:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),qt._abbr}function ae(t,e){if(null!==e){var s,i=te;if(e.abbr=t,null!=ee[t])Y("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),i=ee[t]._config;else if(null!=e.parentLocale)if(null!=ee[e.parentLocale])i=ee[e.parentLocale]._config;else{if(null==(s=ne(e.parentLocale)))return se[e.parentLocale]||(se[e.parentLocale]=[]),se[e.parentLocale].push({name:t,config:e}),null;i=s._config}return ee[t]=new C(P(i,e)),se[t]&&se[t].forEach((function(t){ae(t.name,t.config)})),re(t),ee[t]}return delete ee[t],null}function oe(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return qt;if(!n(t)){if(e=ne(t))return e;t=[t]}return function(t){for(var e,s,i,n,r=0;r<t.length;){for(e=(n=ie(t[r]).split("-")).length,s=(s=ie(t[r+1]))?s.split("-"):null;e>0;){if(i=ne(n.slice(0,e).join("-")))return i;if(s&&s.length>=e&&S(n,s,!0)>=e-1)break;e--}r++}return qt}(t)}function he(t){var e,s=t._a;return s&&-2===g(t).overflow&&(e=s[1]<0||s[1]>11?1:s[2]<1||s[2]>Mt(s[0],s[1])?2:s[3]<0||s[3]>24||24===s[3]&&(0!==s[4]||0!==s[5]||0!==s[6])?3:s[4]<0||s[4]>59?4:s[5]<0||s[5]>59?5:s[6]<0||s[6]>999?6:-1,g(t)._overflowDayOfYear&&(e<0||e>2)&&(e=2),g(t)._overflowWeeks&&-1===e&&(e=7),g(t)._overflowWeekday&&-1===e&&(e=8),g(t).overflow=e),t}function de(t,e,s){return null!=t?t:null!=e?e:s}function le(t){var e,s,n,r,a,o=[];if(!t._d){for(n=function(t){var e=new Date(i.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}(t),t._w&&null==t._a[2]&&null==t._a[1]&&function(t){var e,s,i,n,r,a,o,h;if(null!=(e=t._w).GG||null!=e.W||null!=e.E)r=1,a=4,s=de(e.GG,t._a[0],At(be(),1,4).year),i=de(e.W,1),((n=de(e.E,1))<1||n>7)&&(h=!0);else{r=t._locale._week.dow,a=t._locale._week.doy;var d=At(be(),r,a);s=de(e.gg,t._a[0],d.year),i=de(e.w,d.week),null!=e.d?((n=e.d)<0||n>6)&&(h=!0):null!=e.e?(n=e.e+r,(e.e<0||e.e>6)&&(h=!0)):n=r}i<1||i>Gt(s,r,a)?g(t)._overflowWeeks=!0:null!=h?g(t)._overflowWeekday=!0:(o=Rt(s,i,n,r,a),t._a[0]=o.year,t._dayOfYear=o.dayOfYear)}(t),null!=t._dayOfYear&&(a=de(t._a[0],n[0]),(t._dayOfYear>vt(a)||0===t._dayOfYear)&&(g(t)._overflowDayOfYear=!0),s=Wt(a,0,t._dayOfYear),t._a[1]=s.getUTCMonth(),t._a[2]=s.getUTCDate()),e=0;e<3&&null==t._a[e];++e)t._a[e]=o[e]=n[e];for(;e<7;e++)t._a[e]=o[e]=null==t._a[e]?2===e?1:0:t._a[e];24===t._a[3]&&0===t._a[4]&&0===t._a[5]&&0===t._a[6]&&(t._nextDay=!0,t._a[3]=0),t._d=(t._useUTC?Wt:Ot).apply(null,o),r=t._useUTC?t._d.getUTCDay():t._d.getDay(),null!=t._tzm&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[3]=24),t._w&&void 0!==t._w.d&&t._w.d!==r&&(g(t).weekdayMismatch=!0)}}var ce=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,ue=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,ge=/Z|[+-]\d\d(?::?\d\d)?/,me=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],fe=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],pe=/^\/?Date\((\-?\d+)/i;function ve(t){var e,s,i,n,r,a,o=t._i,h=ce.exec(o)||ue.exec(o);if(h){for(g(t).iso=!0,e=0,s=me.length;e<s;e++)if(me[e][1].exec(h[1])){n=me[e][0],i=!1!==me[e][2];break}if(null==n)return void(t._isValid=!1);if(h[3]){for(e=0,s=fe.length;e<s;e++)if(fe[e][1].exec(h[3])){r=(h[2]||" ")+fe[e][0];break}if(null==r)return void(t._isValid=!1)}if(!i&&null!=r)return void(t._isValid=!1);if(h[4]){if(!ge.exec(h[4]))return void(t._isValid=!1);a="Z"}t._f=n+(r||"")+(a||""),De(t)}else t._isValid=!1}var we=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;function ye(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}var _e={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function ke(t){var e,s,i,n,r,a,o,h=we.exec(t._i.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""));if(h){var d=(e=h[4],s=h[3],i=h[2],n=h[5],r=h[6],a=h[7],o=[ye(e),xt.indexOf(s),parseInt(i,10),parseInt(n,10),parseInt(r,10)],a&&o.push(parseInt(a,10)),o);if(!function(t,e,s){return!t||jt.indexOf(t)===new Date(e[0],e[1],e[2]).getDay()||(g(s).weekdayMismatch=!0,s._isValid=!1,!1)}(h[1],d,t))return;t._a=d,t._tzm=function(t,e,s){if(t)return _e[t];if(e)return 0;var i=parseInt(s,10),n=i%100;return(i-n)/100*60+n}(h[8],h[9],h[10]),t._d=Wt.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),g(t).rfc2822=!0}else t._isValid=!1}function De(t){if(t._f!==i.ISO_8601)if(t._f!==i.RFC_2822){t._a=[],g(t).empty=!0;var e,s,n,r,a,o=""+t._i,h=o.length,d=0;for(n=V(t._f,t._locale).match(z)||[],e=0;e<n.length;e++)r=n[e],(s=(o.match(ct(r,t))||[])[0])&&((a=o.substr(0,o.indexOf(s))).length>0&&g(t).unusedInput.push(a),o=o.slice(o.indexOf(s)+s.length),d+=s.length),I[r]?(s?g(t).empty=!1:g(t).unusedTokens.push(r),pt(r,s,t)):t._strict&&!s&&g(t).unusedTokens.push(r);g(t).charsLeftOver=h-d,o.length>0&&g(t).unusedInput.push(o),t._a[3]<=12&&!0===g(t).bigHour&&t._a[3]>0&&(g(t).bigHour=void 0),g(t).parsedDateParts=t._a.slice(0),g(t).meridiem=t._meridiem,t._a[3]=function(t,e,s){var i;return null==s?e:null!=t.meridiemHour?t.meridiemHour(e,s):null!=t.isPM?((i=t.isPM(s))&&e<12&&(e+=12),i||12!==e||(e=0),e):e}(t._locale,t._a[3],t._meridiem),le(t),he(t)}else ke(t);else ve(t)}function Se(t){var e=t._i,s=t._f;return t._locale=t._locale||oe(t._l),null===e||void 0===s&&""===e?f({nullInput:!0}):("string"==typeof e&&(t._i=e=t._locale.preparse(e)),_(e)?new y(he(e)):(h(e)?t._d=e:n(s)?function(t){var e,s,i,n,r;if(0===t._f.length)return g(t).invalidFormat=!0,void(t._d=new Date(NaN));for(n=0;n<t._f.length;n++)r=0,e=v({},t),null!=t._useUTC&&(e._useUTC=t._useUTC),e._f=t._f[n],De(e),m(e)&&(r+=g(e).charsLeftOver,r+=10*g(e).unusedTokens.length,g(e).score=r,(null==i||r<i)&&(i=r,s=e));c(t,s||e)}(t):s?De(t):function(t){var e=t._i;a(e)?t._d=new Date(i.now()):h(e)?t._d=new Date(e.valueOf()):"string"==typeof e?function(t){var e=pe.exec(t._i);null===e?(ve(t),!1===t._isValid&&(delete t._isValid,ke(t),!1===t._isValid&&(delete t._isValid,i.createFromInputFallback(t)))):t._d=new Date(+e[1])}(t):n(e)?(t._a=d(e.slice(0),(function(t){return parseInt(t,10)})),le(t)):r(e)?function(t){if(!t._d){var e=B(t._i);t._a=d([e.year,e.month,e.day||e.date,e.hour,e.minute,e.second,e.millisecond],(function(t){return t&&parseInt(t,10)})),le(t)}}(t):o(e)?t._d=new Date(e):i.createFromInputFallback(t)}(t),m(t)||(t._d=null),t))}function Me(t,e,s,i,a){var o,h={};return!0!==s&&!1!==s||(i=s,s=void 0),(r(t)&&function(t){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(t).length;var e;for(e in t)if(t.hasOwnProperty(e))return!1;return!0}(t)||n(t)&&0===t.length)&&(t=void 0),h._isAMomentObject=!0,h._useUTC=h._isUTC=a,h._l=s,h._i=t,h._f=e,h._strict=i,(o=new y(he(Se(h))))._nextDay&&(o.add(1,"d"),o._nextDay=void 0),o}function be(t,e,s,i){return Me(t,e,s,i,!1)}i.createFromInputFallback=b("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))})),i.ISO_8601=function(){},i.RFC_2822=function(){};var Ee=b("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var t=be.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:f()})),xe=b("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var t=be.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:f()}));function Le(t,e){var s,i;if(1===e.length&&n(e[0])&&(e=e[0]),!e.length)return be();for(s=e[0],i=1;i<e.length;++i)e[i].isValid()&&!e[i][t](s)||(s=e[i]);return s}var Ye=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Te(t){var e=B(t),s=e.year||0,i=e.quarter||0,n=e.month||0,r=e.week||e.isoWeek||0,a=e.day||0,o=e.hour||0,h=e.minute||0,d=e.second||0,l=e.millisecond||0;this._isValid=function(t){for(var e in t)if(-1===yt.call(Ye,e)||null!=t[e]&&isNaN(t[e]))return!1;for(var s=!1,i=0;i<Ye.length;++i)if(t[Ye[i]]){if(s)return!1;parseFloat(t[Ye[i]])!==D(t[Ye[i]])&&(s=!0)}return!0}(e),this._milliseconds=+l+1e3*d+6e4*h+1e3*o*60*60,this._days=+a+7*r,this._months=+n+3*i+12*s,this._data={},this._locale=oe(),this._bubble()}function Pe(t){return t instanceof Te}function Ce(t){return t<0?-1*Math.round(-1*t):Math.round(t)}function He(t,e){U(t,0,0,(function(){var t=this.utcOffset(),s="+";return t<0&&(t=-t,s="-"),s+G(~~(t/60),2)+e+G(~~t%60,2)}))}He("Z",":"),He("ZZ",""),lt("Z",ot),lt("ZZ",ot),mt(["Z","ZZ"],(function(t,e,s){s._useUTC=!0,s._tzm=We(ot,t)}));var Oe=/([\+\-]|\d\d)/gi;function We(t,e){var s=(e||"").match(t);if(null===s)return null;var i=((s[s.length-1]||[])+"").match(Oe)||["-",0,0],n=60*i[1]+D(i[2]);return 0===n?0:"+"===i[0]?n:-n}function Be(t,e){var s,n;return e._isUTC?(s=e.clone(),n=(_(t)||h(t)?t.valueOf():be(t).valueOf())-s.valueOf(),s._d.setTime(s._d.valueOf()+n),i.updateOffset(s,!1),s):be(t).local()}function Re(t){return 15*-Math.round(t._d.getTimezoneOffset()/15)}function Ae(){return!!this.isValid()&&this._isUTC&&0===this._offset}i.updateOffset=function(){};var Ge=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,ze=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Fe(t,e){var s,i,n,r,a,h,d=t,c=null;return Pe(t)?d={ms:t._milliseconds,d:t._days,M:t._months}:o(t)?(d={},e?d[e]=t:d.milliseconds=t):(c=Ge.exec(t))?(s="-"===c[1]?-1:1,d={y:0,d:D(c[2])*s,h:D(c[3])*s,m:D(c[4])*s,s:D(c[5])*s,ms:D(Ce(1e3*c[6]))*s}):(c=ze.exec(t))?(s="-"===c[1]?-1:1,d={y:je(c[2],s),M:je(c[3],s),w:je(c[4],s),d:je(c[5],s),h:je(c[6],s),m:je(c[7],s),s:je(c[8],s)}):null==d?d={}:"object"==typeof d&&("from"in d||"to"in d)&&(r=be(d.from),a=be(d.to),n=r.isValid()&&a.isValid()?(a=Be(a,r),r.isBefore(a)?h=Ie(r,a):((h=Ie(a,r)).milliseconds=-h.milliseconds,h.months=-h.months),h):{milliseconds:0,months:0},(d={}).ms=n.milliseconds,d.M=n.months),i=new Te(d),Pe(t)&&l(t,"_locale")&&(i._locale=t._locale),i}function je(t,e){var s=t&&parseFloat(t.replace(",","."));return(isNaN(s)?0:s)*e}function Ie(t,e){var s={};return s.months=e.month()-t.month()+12*(e.year()-t.year()),t.clone().add(s.months,"M").isAfter(e)&&--s.months,s.milliseconds=+e-+t.clone().add(s.months,"M"),s}function Ue(t,e){return function(s,i){var n;return null===i||isNaN(+i)||(Y(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),n=s,s=i,i=n),Ne(this,Fe(s="string"==typeof s?+s:s,i),t),this}}function Ne(t,e,s,n){var r=e._milliseconds,a=Ce(e._days),o=Ce(e._months);t.isValid()&&(n=null==n||n,o&&Yt(t,Dt(t,"Month")+o*s),a&&St(t,"Date",Dt(t,"Date")+a*s),r&&t._d.setTime(t._d.valueOf()+r*s),n&&i.updateOffset(t,a||o))}Fe.fn=Te.prototype,Fe.invalid=function(){return Fe(NaN)};var Ve=Ue(1,"add"),$e=Ue(-1,"subtract");function Xe(t,e){var s=12*(e.year()-t.year())+(e.month()-t.month()),i=t.clone().add(s,"months");return-(s+(e-i<0?(e-i)/(i-t.clone().add(s-1,"months")):(e-i)/(t.clone().add(s+1,"months")-i)))||0}function Ze(t){var e;return void 0===t?this._locale._abbr:(null!=(e=oe(t))&&(this._locale=e),this)}i.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",i.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var Ke=b("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(t){return void 0===t?this.localeData():this.locale(t)}));function Je(){return this._locale}function qe(t,e){return(t%e+e)%e}function Qe(t,e,s){return t<100&&t>=0?new Date(t+400,e,s)-126227808e5:new Date(t,e,s).valueOf()}function ts(t,e,s){return t<100&&t>=0?Date.UTC(t+400,e,s)-126227808e5:Date.UTC(t,e,s)}function es(t,e){U(0,[t,t.length],0,e)}function ss(t,e,s,i,n){var r;return null==t?At(this,i,n).year:(e>(r=Gt(t,i,n))&&(e=r),is.call(this,t,e,s,i,n))}function is(t,e,s,i,n){var r=Rt(t,e,s,i,n),a=Wt(r.year,0,r.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}U(0,["gg",2],0,(function(){return this.weekYear()%100})),U(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),es("gggg","weekYear"),es("ggggg","weekYear"),es("GGGG","isoWeekYear"),es("GGGGG","isoWeekYear"),O("weekYear","gg"),O("isoWeekYear","GG"),A("weekYear",1),A("isoWeekYear",1),lt("G",rt),lt("g",rt),lt("GG",q,X),lt("gg",q,X),lt("GGGG",st,K),lt("gggg",st,K),lt("GGGGG",it,J),lt("ggggg",it,J),ft(["gggg","ggggg","GGGG","GGGGG"],(function(t,e,s,i){e[i.substr(0,2)]=D(t)})),ft(["gg","GG"],(function(t,e,s,n){e[n]=i.parseTwoDigitYear(t)})),U("Q",0,"Qo","quarter"),O("quarter","Q"),A("quarter",7),lt("Q",$),mt("Q",(function(t,e){e[1]=3*(D(t)-1)})),U("D",["DD",2],"Do","date"),O("date","D"),A("date",9),lt("D",q),lt("DD",q,X),lt("Do",(function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient})),mt(["D","DD"],2),mt("Do",(function(t,e){e[2]=D(t.match(q)[0])}));var ns=kt("Date",!0);U("DDD",["DDDD",3],"DDDo","dayOfYear"),O("dayOfYear","DDD"),A("dayOfYear",4),lt("DDD",et),lt("DDDD",Z),mt(["DDD","DDDD"],(function(t,e,s){s._dayOfYear=D(t)})),U("m",["mm",2],0,"minute"),O("minute","m"),A("minute",14),lt("m",q),lt("mm",q,X),mt(["m","mm"],4);var rs=kt("Minutes",!1);U("s",["ss",2],0,"second"),O("second","s"),A("second",15),lt("s",q),lt("ss",q,X),mt(["s","ss"],5);var as,os=kt("Seconds",!1);for(U("S",0,0,(function(){return~~(this.millisecond()/100)})),U(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),U(0,["SSS",3],0,"millisecond"),U(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),U(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),U(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),U(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),U(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),U(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),O("millisecond","ms"),A("millisecond",16),lt("S",et,$),lt("SS",et,X),lt("SSS",et,Z),as="SSSS";as.length<=9;as+="S")lt(as,nt);function hs(t,e){e[6]=D(1e3*("0."+t))}for(as="S";as.length<=9;as+="S")mt(as,hs);var ds=kt("Milliseconds",!1);U("z",0,0,"zoneAbbr"),U("zz",0,0,"zoneName");var ls=y.prototype;function cs(t){return t}ls.add=Ve,ls.calendar=function(t,e){var s=t||be(),n=Be(s,this).startOf("day"),r=i.calendarFormat(this,n)||"sameElse",a=e&&(T(e[r])?e[r].call(this,s):e[r]);return this.format(a||this.localeData().calendar(r,this,be(s)))},ls.clone=function(){return new y(this)},ls.diff=function(t,e,s){var i,n,r;if(!this.isValid())return NaN;if(!(i=Be(t,this)).isValid())return NaN;switch(n=6e4*(i.utcOffset()-this.utcOffset()),e=W(e)){case"year":r=Xe(this,i)/12;break;case"month":r=Xe(this,i);break;case"quarter":r=Xe(this,i)/3;break;case"second":r=(this-i)/1e3;break;case"minute":r=(this-i)/6e4;break;case"hour":r=(this-i)/36e5;break;case"day":r=(this-i-n)/864e5;break;case"week":r=(this-i-n)/6048e5;break;default:r=this-i}return s?r:k(r)},ls.endOf=function(t){var e;if(void 0===(t=W(t))||"millisecond"===t||!this.isValid())return this;var s=this._isUTC?ts:Qe;switch(t){case"year":e=s(this.year()+1,0,1)-1;break;case"quarter":e=s(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=s(this.year(),this.month()+1,1)-1;break;case"week":e=s(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=s(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=s(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=36e5-qe(e+(this._isUTC?0:6e4*this.utcOffset()),36e5)-1;break;case"minute":e=this._d.valueOf(),e+=6e4-qe(e,6e4)-1;break;case"second":e=this._d.valueOf(),e+=1e3-qe(e,1e3)-1}return this._d.setTime(e),i.updateOffset(this,!0),this},ls.format=function(t){t||(t=this.isUtc()?i.defaultFormatUtc:i.defaultFormat);var e=N(this,t);return this.localeData().postformat(e)},ls.from=function(t,e){return this.isValid()&&(_(t)&&t.isValid()||be(t).isValid())?Fe({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()},ls.fromNow=function(t){return this.from(be(),t)},ls.to=function(t,e){return this.isValid()&&(_(t)&&t.isValid()||be(t).isValid())?Fe({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()},ls.toNow=function(t){return this.to(be(),t)},ls.get=function(t){return T(this[t=W(t)])?this[t]():this},ls.invalidAt=function(){return g(this).overflow},ls.isAfter=function(t,e){var s=_(t)?t:be(t);return!(!this.isValid()||!s.isValid())&&("millisecond"===(e=W(e)||"millisecond")?this.valueOf()>s.valueOf():s.valueOf()<this.clone().startOf(e).valueOf())},ls.isBefore=function(t,e){var s=_(t)?t:be(t);return!(!this.isValid()||!s.isValid())&&("millisecond"===(e=W(e)||"millisecond")?this.valueOf()<s.valueOf():this.clone().endOf(e).valueOf()<s.valueOf())},ls.isBetween=function(t,e,s,i){var n=_(t)?t:be(t),r=_(e)?e:be(e);return!!(this.isValid()&&n.isValid()&&r.isValid())&&("("===(i=i||"()")[0]?this.isAfter(n,s):!this.isBefore(n,s))&&(")"===i[1]?this.isBefore(r,s):!this.isAfter(r,s))},ls.isSame=function(t,e){var s,i=_(t)?t:be(t);return!(!this.isValid()||!i.isValid())&&("millisecond"===(e=W(e)||"millisecond")?this.valueOf()===i.valueOf():(s=i.valueOf(),this.clone().startOf(e).valueOf()<=s&&s<=this.clone().endOf(e).valueOf()))},ls.isSameOrAfter=function(t,e){return this.isSame(t,e)||this.isAfter(t,e)},ls.isSameOrBefore=function(t,e){return this.isSame(t,e)||this.isBefore(t,e)},ls.isValid=function(){return m(this)},ls.lang=Ke,ls.locale=Ze,ls.localeData=Je,ls.max=xe,ls.min=Ee,ls.parsingFlags=function(){return c({},g(this))},ls.set=function(t,e){if("object"==typeof t)for(var s=function(t){var e=[];for(var s in t)e.push({unit:s,priority:R[s]});return e.sort((function(t,e){return t.priority-e.priority})),e}(t=B(t)),i=0;i<s.length;i++)this[s[i].unit](t[s[i].unit]);else if(T(this[t=W(t)]))return this[t](e);return this},ls.startOf=function(t){var e;if(void 0===(t=W(t))||"millisecond"===t||!this.isValid())return this;var s=this._isUTC?ts:Qe;switch(t){case"year":e=s(this.year(),0,1);break;case"quarter":e=s(this.year(),this.month()-this.month()%3,1);break;case"month":e=s(this.year(),this.month(),1);break;case"week":e=s(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=s(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=s(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=qe(e+(this._isUTC?0:6e4*this.utcOffset()),36e5);break;case"minute":e=this._d.valueOf(),e-=qe(e,6e4);break;case"second":e=this._d.valueOf(),e-=qe(e,1e3)}return this._d.setTime(e),i.updateOffset(this,!0),this},ls.subtract=$e,ls.toArray=function(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]},ls.toObject=function(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}},ls.toDate=function(){return new Date(this.valueOf())},ls.toISOString=function(t){if(!this.isValid())return null;var e=!0!==t,s=e?this.clone().utc():this;return s.year()<0||s.year()>9999?N(s,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):T(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",N(s,"Z")):N(s,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},ls.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="";this.isLocal()||(t=0===this.utcOffset()?"moment.utc":"moment.parseZone",e="Z");var s="["+t+'("]',i=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",n=e+'[")]';return this.format(s+i+"-MM-DD[T]HH:mm:ss.SSS"+n)},ls.toJSON=function(){return this.isValid()?this.toISOString():null},ls.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},ls.unix=function(){return Math.floor(this.valueOf()/1e3)},ls.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},ls.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},ls.year=_t,ls.isLeapYear=function(){return wt(this.year())},ls.weekYear=function(t){return ss.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},ls.isoWeekYear=function(t){return ss.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)},ls.quarter=ls.quarters=function(t){return null==t?Math.ceil((this.month()+1)/3):this.month(3*(t-1)+this.month()%3)},ls.month=Tt,ls.daysInMonth=function(){return Mt(this.year(),this.month())},ls.week=ls.weeks=function(t){var e=this.localeData().week(this);return null==t?e:this.add(7*(t-e),"d")},ls.isoWeek=ls.isoWeeks=function(t){var e=At(this,1,4).week;return null==t?e:this.add(7*(t-e),"d")},ls.weeksInYear=function(){var t=this.localeData()._week;return Gt(this.year(),t.dow,t.doy)},ls.isoWeeksInYear=function(){return Gt(this.year(),1,4)},ls.date=ns,ls.day=ls.days=function(t){if(!this.isValid())return null!=t?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=t?(t=function(t,e){return"string"!=typeof t?t:isNaN(t)?"number"==typeof(t=e.weekdaysParse(t))?t:null:parseInt(t,10)}(t,this.localeData()),this.add(t-e,"d")):e},ls.weekday=function(t){if(!this.isValid())return null!=t?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return null==t?e:this.add(t-e,"d")},ls.isoWeekday=function(t){if(!this.isValid())return null!=t?this:NaN;if(null!=t){var e=function(t,e){return"string"==typeof t?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}(t,this.localeData());return this.day(this.day()%7?e:e-7)}return this.day()||7},ls.dayOfYear=function(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==t?e:this.add(t-e,"d")},ls.hour=ls.hours=Qt,ls.minute=ls.minutes=rs,ls.second=ls.seconds=os,ls.millisecond=ls.milliseconds=ds,ls.utcOffset=function(t,e,s){var n,r=this._offset||0;if(!this.isValid())return null!=t?this:NaN;if(null!=t){if("string"==typeof t){if(null===(t=We(ot,t)))return this}else Math.abs(t)<16&&!s&&(t*=60);return!this._isUTC&&e&&(n=Re(this)),this._offset=t,this._isUTC=!0,null!=n&&this.add(n,"m"),r!==t&&(!e||this._changeInProgress?Ne(this,Fe(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,i.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?r:Re(this)},ls.utc=function(t){return this.utcOffset(0,t)},ls.local=function(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(Re(this),"m")),this},ls.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var t=We(at,this._i);null!=t?this.utcOffset(t):this.utcOffset(0,!0)}return this},ls.hasAlignedHourOffset=function(t){return!!this.isValid()&&(t=t?be(t).utcOffset():0,(this.utcOffset()-t)%60==0)},ls.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},ls.isLocal=function(){return!!this.isValid()&&!this._isUTC},ls.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},ls.isUtc=Ae,ls.isUTC=Ae,ls.zoneAbbr=function(){return this._isUTC?"UTC":""},ls.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},ls.dates=b("dates accessor is deprecated. Use date instead.",ns),ls.months=b("months accessor is deprecated. Use month instead",Tt),ls.years=b("years accessor is deprecated. Use year instead",_t),ls.zone=b("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",(function(t,e){return null!=t?("string"!=typeof t&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()})),ls.isDSTShifted=b("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",(function(){if(!a(this._isDSTShifted))return this._isDSTShifted;var t={};if(v(t,this),(t=Se(t))._a){var e=t._isUTC?u(t._a):be(t._a);this._isDSTShifted=this.isValid()&&S(t._a,e.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}));var us=C.prototype;function gs(t,e,s,i){var n=oe(),r=u().set(i,e);return n[s](r,t)}function ms(t,e,s){if(o(t)&&(e=t,t=void 0),t=t||"",null!=e)return gs(t,e,s,"month");var i,n=[];for(i=0;i<12;i++)n[i]=gs(t,i,s,"month");return n}function fs(t,e,s,i){"boolean"==typeof t?(o(e)&&(s=e,e=void 0),e=e||""):(s=e=t,t=!1,o(e)&&(s=e,e=void 0),e=e||"");var n,r=oe(),a=t?r._week.dow:0;if(null!=s)return gs(e,(s+a)%7,i,"day");var h=[];for(n=0;n<7;n++)h[n]=gs(e,(n+a)%7,i,"day");return h}us.calendar=function(t,e,s){var i=this._calendar[t]||this._calendar.sameElse;return T(i)?i.call(e,s):i},us.longDateFormat=function(t){var e=this._longDateFormat[t],s=this._longDateFormat[t.toUpperCase()];return e||!s?e:(this._longDateFormat[t]=s.replace(/MMMM|MM|DD|dddd/g,(function(t){return t.slice(1)})),this._longDateFormat[t])},us.invalidDate=function(){return this._invalidDate},us.ordinal=function(t){return this._ordinal.replace("%d",t)},us.preparse=cs,us.postformat=cs,us.relativeTime=function(t,e,s,i){var n=this._relativeTime[s];return T(n)?n(t,e,s,i):n.replace(/%d/i,t)},us.pastFuture=function(t,e){var s=this._relativeTime[t>0?"future":"past"];return T(s)?s(e):s.replace(/%s/i,e)},us.set=function(t){var e,s;for(s in t)T(e=t[s])?this[s]=e:this["_"+s]=e;this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},us.months=function(t,e){return t?n(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||bt).test(e)?"format":"standalone"][t.month()]:n(this._months)?this._months:this._months.standalone},us.monthsShort=function(t,e){return t?n(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[bt.test(e)?"format":"standalone"][t.month()]:n(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},us.monthsParse=function(t,e,s){var i,n,r;if(this._monthsParseExact)return Lt.call(this,t,e,s);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(n=u([2e3,i]),s&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(n,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(n,"").replace(".","")+"$","i")),s||this._monthsParse[i]||(r="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[i]=new RegExp(r.replace(".",""),"i")),s&&"MMMM"===e&&this._longMonthsParse[i].test(t))return i;if(s&&"MMM"===e&&this._shortMonthsParse[i].test(t))return i;if(!s&&this._monthsParse[i].test(t))return i}},us.monthsRegex=function(t){return this._monthsParseExact?(l(this,"_monthsRegex")||Ht.call(this),t?this._monthsStrictRegex:this._monthsRegex):(l(this,"_monthsRegex")||(this._monthsRegex=Ct),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)},us.monthsShortRegex=function(t){return this._monthsParseExact?(l(this,"_monthsRegex")||Ht.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(l(this,"_monthsShortRegex")||(this._monthsShortRegex=Pt),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)},us.week=function(t){return At(t,this._week.dow,this._week.doy).week},us.firstDayOfYear=function(){return this._week.doy},us.firstDayOfWeek=function(){return this._week.dow},us.weekdays=function(t,e){var s=n(this._weekdays)?this._weekdays:this._weekdays[t&&!0!==t&&this._weekdays.isFormat.test(e)?"format":"standalone"];return!0===t?zt(s,this._week.dow):t?s[t.day()]:s},us.weekdaysMin=function(t){return!0===t?zt(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin},us.weekdaysShort=function(t){return!0===t?zt(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort},us.weekdaysParse=function(t,e,s){var i,n,r;if(this._weekdaysParseExact)return Ut.call(this,t,e,s);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(n=u([2e3,1]).day(i),s&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(n,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(n,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(n,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[i]||(r="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[i]=new RegExp(r.replace(".",""),"i")),s&&"dddd"===e&&this._fullWeekdaysParse[i].test(t))return i;if(s&&"ddd"===e&&this._shortWeekdaysParse[i].test(t))return i;if(s&&"dd"===e&&this._minWeekdaysParse[i].test(t))return i;if(!s&&this._weekdaysParse[i].test(t))return i}},us.weekdaysRegex=function(t){return this._weekdaysParseExact?(l(this,"_weekdaysRegex")||Xt.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(l(this,"_weekdaysRegex")||(this._weekdaysRegex=Nt),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)},us.weekdaysShortRegex=function(t){return this._weekdaysParseExact?(l(this,"_weekdaysRegex")||Xt.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(l(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Vt),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},us.weekdaysMinRegex=function(t){return this._weekdaysParseExact?(l(this,"_weekdaysRegex")||Xt.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(l(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=$t),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},us.isPM=function(t){return"p"===(t+"").toLowerCase().charAt(0)},us.meridiem=function(t,e,s){return t>11?s?"pm":"PM":s?"am":"AM"},re("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10;return t+(1===D(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th")}}),i.lang=b("moment.lang is deprecated. Use moment.locale instead.",re),i.langData=b("moment.langData is deprecated. Use moment.localeData instead.",oe);var ps=Math.abs;function vs(t,e,s,i){var n=Fe(e,s);return t._milliseconds+=i*n._milliseconds,t._days+=i*n._days,t._months+=i*n._months,t._bubble()}function ws(t){return t<0?Math.floor(t):Math.ceil(t)}function ys(t){return 4800*t/146097}function _s(t){return 146097*t/4800}function ks(t){return function(){return this.as(t)}}var Ds=ks("ms"),Ss=ks("s"),Ms=ks("m"),bs=ks("h"),Es=ks("d"),xs=ks("w"),Ls=ks("M"),Ys=ks("Q"),Ts=ks("y");function Ps(t){return function(){return this.isValid()?this._data[t]:NaN}}var Cs=Ps("milliseconds"),Hs=Ps("seconds"),Os=Ps("minutes"),Ws=Ps("hours"),Bs=Ps("days"),Rs=Ps("months"),As=Ps("years"),Gs=Math.round,zs={ss:44,s:45,m:45,h:22,d:26,M:11};function Fs(t,e,s,i,n){return n.relativeTime(e||1,!!s,t,i)}var js=Math.abs;function Is(t){return(t>0)-(t<0)||+t}function Us(){if(!this.isValid())return this.localeData().invalidDate();var t,e,s=js(this._milliseconds)/1e3,i=js(this._days),n=js(this._months);t=k(s/60),e=k(t/60),s%=60,t%=60;var r=k(n/12),a=n%=12,o=i,h=e,d=t,l=s?s.toFixed(3).replace(/\.?0+$/,""):"",c=this.asSeconds();if(!c)return"P0D";var u=c<0?"-":"",g=Is(this._months)!==Is(c)?"-":"",m=Is(this._days)!==Is(c)?"-":"",f=Is(this._milliseconds)!==Is(c)?"-":"";return u+"P"+(r?g+r+"Y":"")+(a?g+a+"M":"")+(o?m+o+"D":"")+(h||d||l?"T":"")+(h?f+h+"H":"")+(d?f+d+"M":"")+(l?f+l+"S":"")}var Ns=Te.prototype;return Ns.isValid=function(){return this._isValid},Ns.abs=function(){var t=this._data;return this._milliseconds=ps(this._milliseconds),this._days=ps(this._days),this._months=ps(this._months),t.milliseconds=ps(t.milliseconds),t.seconds=ps(t.seconds),t.minutes=ps(t.minutes),t.hours=ps(t.hours),t.months=ps(t.months),t.years=ps(t.years),this},Ns.add=function(t,e){return vs(this,t,e,1)},Ns.subtract=function(t,e){return vs(this,t,e,-1)},Ns.as=function(t){if(!this.isValid())return NaN;var e,s,i=this._milliseconds;if("month"===(t=W(t))||"quarter"===t||"year"===t)switch(e=this._days+i/864e5,s=this._months+ys(e),t){case"month":return s;case"quarter":return s/3;case"year":return s/12}else switch(e=this._days+Math.round(_s(this._months)),t){case"week":return e/7+i/6048e5;case"day":return e+i/864e5;case"hour":return 24*e+i/36e5;case"minute":return 1440*e+i/6e4;case"second":return 86400*e+i/1e3;case"millisecond":return Math.floor(864e5*e)+i;default:throw new Error("Unknown unit "+t)}},Ns.asMilliseconds=Ds,Ns.asSeconds=Ss,Ns.asMinutes=Ms,Ns.asHours=bs,Ns.asDays=Es,Ns.asWeeks=xs,Ns.asMonths=Ls,Ns.asQuarters=Ys,Ns.asYears=Ts,Ns.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*D(this._months/12):NaN},Ns._bubble=function(){var t,e,s,i,n,r=this._milliseconds,a=this._days,o=this._months,h=this._data;return r>=0&&a>=0&&o>=0||r<=0&&a<=0&&o<=0||(r+=864e5*ws(_s(o)+a),a=0,o=0),h.milliseconds=r%1e3,t=k(r/1e3),h.seconds=t%60,e=k(t/60),h.minutes=e%60,s=k(e/60),h.hours=s%24,a+=k(s/24),n=k(ys(a)),o+=n,a-=ws(_s(n)),i=k(o/12),o%=12,h.days=a,h.months=o,h.years=i,this},Ns.clone=function(){return Fe(this)},Ns.get=function(t){return t=W(t),this.isValid()?this[t+"s"]():NaN},Ns.milliseconds=Cs,Ns.seconds=Hs,Ns.minutes=Os,Ns.hours=Ws,Ns.days=Bs,Ns.weeks=function(){return k(this.days()/7)},Ns.months=Rs,Ns.years=As,Ns.humanize=function(t){if(!this.isValid())return this.localeData().invalidDate();var e=this.localeData(),s=function(t,e,s){var i=Fe(t).abs(),n=Gs(i.as("s")),r=Gs(i.as("m")),a=Gs(i.as("h")),o=Gs(i.as("d")),h=Gs(i.as("M")),d=Gs(i.as("y")),l=n<=zs.ss&&["s",n]||n<zs.s&&["ss",n]||r<=1&&["m"]||r<zs.m&&["mm",r]||a<=1&&["h"]||a<zs.h&&["hh",a]||o<=1&&["d"]||o<zs.d&&["dd",o]||h<=1&&["M"]||h<zs.M&&["MM",h]||d<=1&&["y"]||["yy",d];return l[2]=e,l[3]=+t>0,l[4]=s,Fs.apply(null,l)}(this,!t,e);return t&&(s=e.pastFuture(+this,s)),e.postformat(s)},Ns.toISOString=Us,Ns.toString=Us,Ns.toJSON=Us,Ns.locale=Ze,Ns.localeData=Je,Ns.toIsoString=b("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Us),Ns.lang=Ke,U("X",0,0,"unix"),U("x",0,0,"valueOf"),lt("x",rt),lt("X",/[+-]?\d+(\.\d{1,3})?/),mt("X",(function(t,e,s){s._d=new Date(1e3*parseFloat(t,10))})),mt("x",(function(t,e,s){s._d=new Date(D(t))})),i.version="2.24.0",e=be,i.fn=ls,i.min=function(){var t=[].slice.call(arguments,0);return Le("isBefore",t)},i.max=function(){var t=[].slice.call(arguments,0);return Le("isAfter",t)},i.now=function(){return Date.now?Date.now():+new Date},i.utc=u,i.unix=function(t){return be(1e3*t)},i.months=function(t,e){return ms(t,e,"months")},i.isDate=h,i.locale=re,i.invalid=f,i.duration=Fe,i.isMoment=_,i.weekdays=function(t,e,s){return fs(t,e,s,"weekdays")},i.parseZone=function(){return be.apply(null,arguments).parseZone()},i.localeData=oe,i.isDuration=Pe,i.monthsShort=function(t,e){return ms(t,e,"monthsShort")},i.weekdaysMin=function(t,e,s){return fs(t,e,s,"weekdaysMin")},i.defineLocale=ae,i.updateLocale=function(t,e){if(null!=e){var s,i,n=te;null!=(i=ne(t))&&(n=i._config),e=P(n,e),(s=new C(e)).parentLocale=ee[t],ee[t]=s,re(t)}else null!=ee[t]&&(null!=ee[t].parentLocale?ee[t]=ee[t].parentLocale:null!=ee[t]&&delete ee[t]);return ee[t]},i.locales=function(){return x(ee)},i.weekdaysShort=function(t,e,s){return fs(t,e,s,"weekdaysShort")},i.normalizeUnits=W,i.relativeTimeRounding=function(t){return void 0===t?Gs:"function"==typeof t&&(Gs=t,!0)},i.relativeTimeThreshold=function(t,e){return void 0!==zs[t]&&(void 0===e?zs[t]:(zs[t]=e,"s"===t&&(zs.ss=e-1),!0))},i.calendarFormat=function(t,e){var s=t.diff(e,"days",!0);return s<-6?"sameElse":s<-1?"lastWeek":s<0?"lastDay":s<1?"sameDay":s<2?"nextDay":s<7?"nextWeek":"sameElse"},i.prototype=ls,i.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},i}()})),P=x((function(t,e){(function(t){t.defineLocale("en-gb",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(t){var e=t%10;return t+(1==~~(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th")},week:{dow:1,doy:4}})})(T)})),C=x((function(t,e){(function(t){var e="január_február_marec_apríl_máj_jún_júl_august_september_október_november_december".split("_"),s="jan_feb_mar_apr_máj_jún_júl_aug_sep_okt_nov_dec".split("_");function i(t){return t>1&&t<5}function n(t,e,s,n){var r=t+" ";switch(s){case"s":return e||n?"pár sekúnd":"pár sekundami";case"ss":return e||n?r+(i(t)?"sekundy":"sekúnd"):r+"sekundami";case"m":return e?"minúta":n?"minútu":"minútou";case"mm":return e||n?r+(i(t)?"minúty":"minút"):r+"minútami";case"h":return e?"hodina":n?"hodinu":"hodinou";case"hh":return e||n?r+(i(t)?"hodiny":"hodín"):r+"hodinami";case"d":return e||n?"deň":"dňom";case"dd":return e||n?r+(i(t)?"dni":"dní"):r+"dňami";case"M":return e||n?"mesiac":"mesiacom";case"MM":return e||n?r+(i(t)?"mesiace":"mesiacov"):r+"mesiacmi";case"y":return e||n?"rok":"rokom";case"yy":return e||n?r+(i(t)?"roky":"rokov"):r+"rokmi"}}t.defineLocale("sk",{months:e,monthsShort:s,weekdays:"nedeľa_pondelok_utorok_streda_štvrtok_piatok_sobota".split("_"),weekdaysShort:"ne_po_ut_st_št_pi_so".split("_"),weekdaysMin:"ne_po_ut_st_št_pi_so".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd D. MMMM YYYY H:mm"},calendar:{sameDay:"[dnes o] LT",nextDay:"[zajtra o] LT",nextWeek:function(){switch(this.day()){case 0:return"[v nedeľu o] LT";case 1:case 2:return"[v] dddd [o] LT";case 3:return"[v stredu o] LT";case 4:return"[vo štvrtok o] LT";case 5:return"[v piatok o] LT";case 6:return"[v sobotu o] LT"}},lastDay:"[včera o] LT",lastWeek:function(){switch(this.day()){case 0:return"[minulú nedeľu o] LT";case 1:case 2:return"[minulý] dddd [o] LT";case 3:return"[minulú stredu o] LT";case 4:case 5:return"[minulý] dddd [o] LT";case 6:return"[minulú sobotu o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"pred %s",s:n,ss:n,m:n,mm:n,h:n,hh:n,d:n,dd:n,M:n,MM:n,y:n,yy:n},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})(T)})),H=x((function(t,e){(function(t){var e="leden_únor_březen_duben_květen_červen_červenec_srpen_září_říjen_listopad_prosinec".split("_"),s="led_úno_bře_dub_kvě_čvn_čvc_srp_zář_říj_lis_pro".split("_"),i=[/^led/i,/^úno/i,/^bře/i,/^dub/i,/^kvě/i,/^(čvn|červen$|června)/i,/^(čvc|červenec|července)/i,/^srp/i,/^zář/i,/^říj/i,/^lis/i,/^pro/i],n=/^(leden|únor|březen|duben|květen|červenec|července|červen|června|srpen|září|říjen|listopad|prosinec|led|úno|bře|dub|kvě|čvn|čvc|srp|zář|říj|lis|pro)/i;function r(t){return t>1&&t<5&&1!=~~(t/10)}function a(t,e,s,i){var n=t+" ";switch(s){case"s":return e||i?"pár sekund":"pár sekundami";case"ss":return e||i?n+(r(t)?"sekundy":"sekund"):n+"sekundami";case"m":return e?"minuta":i?"minutu":"minutou";case"mm":return e||i?n+(r(t)?"minuty":"minut"):n+"minutami";case"h":return e?"hodina":i?"hodinu":"hodinou";case"hh":return e||i?n+(r(t)?"hodiny":"hodin"):n+"hodinami";case"d":return e||i?"den":"dnem";case"dd":return e||i?n+(r(t)?"dny":"dní"):n+"dny";case"M":return e||i?"měsíc":"měsícem";case"MM":return e||i?n+(r(t)?"měsíce":"měsíců"):n+"měsíci";case"y":return e||i?"rok":"rokem";case"yy":return e||i?n+(r(t)?"roky":"let"):n+"lety"}}t.defineLocale("cs",{months:e,monthsShort:s,monthsRegex:n,monthsShortRegex:n,monthsStrictRegex:/^(leden|ledna|února|únor|březen|března|duben|dubna|květen|května|červenec|července|červen|června|srpen|srpna|září|říjen|října|listopadu|listopad|prosinec|prosince)/i,monthsShortStrictRegex:/^(led|úno|bře|dub|kvě|čvn|čvc|srp|zář|říj|lis|pro)/i,monthsParse:i,longMonthsParse:i,shortMonthsParse:i,weekdays:"neděle_pondělí_úterý_středa_čtvrtek_pátek_sobota".split("_"),weekdaysShort:"ne_po_út_st_čt_pá_so".split("_"),weekdaysMin:"ne_po_út_st_čt_pá_so".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd D. MMMM YYYY H:mm",l:"D. M. YYYY"},calendar:{sameDay:"[dnes v] LT",nextDay:"[zítra v] LT",nextWeek:function(){switch(this.day()){case 0:return"[v neděli v] LT";case 1:case 2:return"[v] dddd [v] LT";case 3:return"[ve středu v] LT";case 4:return"[ve čtvrtek v] LT";case 5:return"[v pátek v] LT";case 6:return"[v sobotu v] LT"}},lastDay:"[včera v] LT",lastWeek:function(){switch(this.day()){case 0:return"[minulou neděli v] LT";case 1:case 2:return"[minulé] dddd [v] LT";case 3:return"[minulou středu v] LT";case 4:case 5:return"[minulý] dddd [v] LT";case 6:return"[minulou sobotu v] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"před %s",s:a,ss:a,m:a,mm:a,h:a,hh:a,d:a,dd:a,M:a,MM:a,y:a,yy:a},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})(T)})),O=x((function(t,e){(function(t){function e(t,e,s,i){var n={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[t+" Tage",t+" Tagen"],M:["ein Monat","einem Monat"],MM:[t+" Monate",t+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[t+" Jahre",t+" Jahren"]};return e?n[s][0]:n[s][1]}t.defineLocale("de",{months:"Januar_Februar_März_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Feb._März_Apr._Mai_Juni_Juli_Aug._Sep._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},calendar:{sameDay:"[heute um] LT [Uhr]",sameElse:"L",nextDay:"[morgen um] LT [Uhr]",nextWeek:"dddd [um] LT [Uhr]",lastDay:"[gestern um] LT [Uhr]",lastWeek:"[letzten] dddd [um] LT [Uhr]"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",ss:"%d Sekunden",m:e,mm:"%d Minuten",h:e,hh:"%d Stunden",d:e,dd:e,M:e,MM:e,y:e,yy:e},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})(T)})),W=x((function(t,e){(function(t){var e="ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),s="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),i=[/^ene/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i],n=/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre|ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i;t.defineLocale("es",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:function(t,i){return t?/-MMM-/.test(i)?s[t.month()]:e[t.month()]:e},monthsRegex:n,monthsShortRegex:n,monthsStrictRegex:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i,monthsShortStrictRegex:/^(ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i,monthsParse:i,longMonthsParse:i,shortMonthsParse:i,weekdays:"domingo_lunes_martes_miércoles_jueves_viernes_sábado".split("_"),weekdaysShort:"dom._lun._mar._mié._jue._vie._sáb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_sá".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[mañana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",ss:"%d segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un día",dd:"%d días",M:"un mes",MM:"%d meses",y:"un año",yy:"%d años"},dayOfMonthOrdinalParse:/\d{1,2}º/,ordinal:"%dº",week:{dow:1,doy:4}})})(T)})),B=x((function(t,e){(function(t){t.defineLocale("fr",{months:"janvier_février_mars_avril_mai_juin_juillet_août_septembre_octobre_novembre_décembre".split("_"),monthsShort:"janv._févr._mars_avr._mai_juin_juil._août_sept._oct._nov._déc.".split("_"),monthsParseExact:!0,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourd’hui à] LT",nextDay:"[Demain à] LT",nextWeek:"dddd [à] LT",lastDay:"[Hier à] LT",lastWeek:"dddd [dernier à] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",ss:"%d secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|)/,ordinal:function(t,e){switch(e){case"D":return t+(1===t?"er":"");default:case"M":case"Q":case"DDD":case"d":return t+(1===t?"er":"e");case"w":case"W":return t+(1===t?"re":"e")}},week:{dow:1,doy:4}})})(T)}));function R(t){switch(t){case"sk":T.updateLocale(t,C);break;case"cs":T.updateLocale(t,H);break;case"de":T.updateLocale(t,O);break;case"es":T.updateLocale(t,W);break;case"fr":T.updateLocale(t,B);break;default:T.updateLocale("en",P)}}function A(t,e){if("string"==typeof t){const s=T.utc(t,e).toDate();if(function(t){var e;return(null===(e=t)||void 0===e?void 0:e.getTime)&&!isNaN(t.getTime())}(s))return s}return null}function G(t,e){return T.utc(t).startOf(e).toDate()}function z(){return T.utc().toDate()}function F(){const t=new Date;return T.utc([t.getFullYear(),t.getMonth(),t.getDate()]).startOf("day").toDate()}function j(t,e,s){return T.utc(t).add(e,s).toDate()}function I(t){return T.utc(t).daysInMonth()}function U(t,e){return T.utc(t).format(e)}function N(t,e,s){return T.utc(t).diff(T.utc(e),s)}function V(t,e){return t.getTime()>e.getTime()}function $(t,e){return t.getTime()<e.getTime()}!function(t){t.Year="year",t.Month="month",t.Week="week",t.Day="day",t.Hour="hour",t.Second="second",t.Millisecond="millisecond"}(L||(L={})),(Y=t.GanttSwimlaneType||(t.GanttSwimlaneType={})).Text="text",Y.Checkbox="checkbox";const X=["id","name","start","end","progress","swimlanes","dependencies","allowedDependencies","barColor","progressColor","textColor","startDrag","endDrag","progressDrag","editable","minProgress","maxProgress"];function Z(t){const e=function(t,e){const i=Object.assign({},t);return Object.keys(e||{}).forEach(n=>{const r=e[n];s(r)&&""!==r&&(o(r)?i[n]=h(r)>=0?h(r):t[n]:i[n]=r)}),i}(b,t);return e.headerHeight=Math.max(e.headerHeight,30),e.columnWidth=Math.max(e.columnWidth,20),e.barHeight=Math.max(e.barHeight,10),e.maxInitialSwimlaneWidth=Math.max(e.maxInitialSwimlaneWidth,30),e.checkboxSize=Math.max(e.checkboxSize,10),e.avatarSize=Math.max(e.avatarSize,12),e.avatarPadding=Math.max(e.avatarPadding,2),e.textBackgroundPadding=Math.max(e.textBackgroundPadding,4),e}function K(e,s,i){if(e.viewMode===t.GanttMode.Month){let t=0;for(const n of s.dates){const r=q(e,n);if(n.getTime()>i.getTime()){const e=s.hoursStep/30*I(n);return t+N(i,n,L.Hour)/e*r}t+=r}return t}return N(i,s.minDate,L.Hour)/s.hoursStep*q(e)}function J(e,s,i){if(e.viewMode===t.GanttMode.Month){let t=0;for(const n of s.dates){const r=q(e,n);if(t+r>i){return j(n,(i-t)/r*(s.hoursStep/30*I(n)),L.Hour)}t+=r}return s.maxDate}const n=i/q(e)*s.hoursStep;return j(s.minDate,n,L.Hour)}function q(e,s){const i=e.columnWidth*function(e){switch(e){case t.GanttMode.Week:case t.GanttMode.Month:return 4;case t.GanttMode.Year:return 12;default:return 1}}(e.viewMode);if(e.viewMode===t.GanttMode.Month&&s){return i/30*I(s)}return i}function Q(e){switch(e){case t.GanttMode.QuarterDay:return.25;case t.GanttMode.HalfDay:return.5;case t.GanttMode.Week:return 7;case t.GanttMode.Month:return 30;case t.GanttMode.Year:return 365;default:return 1}}function tt(e,s,i){switch(s){case t.GanttMode.Year:return j(e,1,L.Year);case t.GanttMode.Month:return j(e,1,L.Month);default:return j(e,i,L.Hour)}}function et(e){switch(e){case t.GanttMode.QuarterDay:case t.GanttMode.HalfDay:return{value:1,scale:L.Month};case t.GanttMode.Month:return{value:1,scale:L.Year};case t.GanttMode.Year:return{value:2,scale:L.Year};default:return{value:2,scale:L.Month}}}function st(t){return it(t.headerHeight,t.rowHeights)}function it(t,e){return(t||0)+(e||[]).reduce((t,e)=>t+e,0)}function nt(t){return(t||"")+"_"+Math.random().toString(36)}function rt(t,e){const s=function(t,e){const s=[];let i=0;const n=(t||[]).reduce((t,n)=>{var r;if((n.swimlanes||[]).some(t=>!!t)){let s,a=1;e[0]&&e[0].static||(s=t.find(t=>dt(t)===dt(n.swimlanes[0])));const o=1===n.swimlanes.length;s?(ht(s,n.swimlanes[0]),o&&s.tasks.push(n)):(s=Object.assign(Object.assign({},n.swimlanes[0]),{value:dt(n.swimlanes[0]),title:(null===(r=n.swimlanes[0])||void 0===r?void 0:r.title)||"",children:[],tasks:o?[n]:[]}),t.push(s)),n.swimlanes.slice(1).forEach((t,i)=>{var r;let o;e[i+1]&&e[i+1].static||(o=s.children.find(e=>dt(e)===dt(t)));const h=i===n.swimlanes.length-2;o?(ht(o,t),h&&o.tasks.push(n)):(o=Object.assign(Object.assign({},t),{value:dt(t),title:(null===(r=t)||void 0===r?void 0:r.title)||"",children:[],tasks:h?[n]:[]}),s.children.push(o)),s=o,a++}),i=Math.max(i,a)}else s.push(n);return t},[]);return{otherTasks:s,lines:n,maxLevel:i}}(t||[],e.swimlaneInfo||[]);if(0===(s.lines||[]).length){const t=s.otherTasks.map(t=>({swimlanes:[],tasks:[t]}));for(let e=t.length;e<5;e++)t.push({swimlanes:[],tasks:[]});return t}const i=[];return s.lines.forEach(t=>function t(e,s,i,n){const r=nt(e.title),a=[...i,Object.assign(Object.assign({},e),{id:r,value:dt(e)})];(e.children||[]).forEach(e=>t(e,s,a,n)),(e.tasks||[]).length>0&&s.push({swimlanes:l(a,n),tasks:e.tasks})}(t,i,[],s.maxLevel)),s.otherTasks.length>0&&i.push({swimlanes:l(null,s.maxLevel),tasks:s.otherTasks}),i}function at(t,e){const s={},i=(t||[]).reduce((t,i)=>{const n=A(i.start,e.dateFormat),r=A(i.end,e.dateFormat);if(!n||!r)return t;const a=i.progress||0,o=nt(i.id);return s[i.id]?s[i.id].push(o):s[i.id]=[o],t[o]=Object.assign(Object.assign({},i),{id:o,taskId:i.id,startDate:n,endDate:r,parentDependencies:[],transitiveDependencies:[],parentTransitiveDependencies:[],progress:a}),t},{});return Object.values(i).forEach(t=>{t.dependencies=(t.dependencies||[]).reduce((t,e)=>(s[e]&&t.push(...s[e]),t),[]),t.allowedDependencies=(t.allowedDependencies||[]).reduce((t,e)=>(s[e]&&t.push(...s[e]),t),[]),t.dependencies.forEach(e=>i[e].parentDependencies.push(t.id))}),ot(i),{tasksMap:i,taskIdsMap:s}}function ot(t){Object.values(t).forEach(e=>{e.transitiveDependencies=lt(e,t),e.parentTransitiveDependencies=lt(e,t,!0)})}function ht(e,s){var i,n,r,a,o;e.textBackground=e.textBackground||(null===(i=s)||void 0===i?void 0:i.textBackground),e.textColor=e.textColor||(null===(n=s)||void 0===n?void 0:n.textColor),e.avatarUrl=e.avatarUrl||(null===(r=s)||void 0===r?void 0:r.avatarUrl),e.background=e.background||(null===(a=s)||void 0===a?void 0:a.background),e.type=e.type||(null===(o=s)||void 0===o?void 0:o.type)||t.GanttSwimlaneType.Text}function dt(t){return t&&(s(t.value)?t.value:t.title)||""}function lt(t,e,s){const i=[...s?t.parentDependencies||[]:t.dependencies||[]];let n=i;for(let t=0;t<Object.keys(e).length&&(n=n.reduce((t,i)=>(t.push(...s?e[i].parentDependencies||[]:e[i].dependencies||[]),t),[]),i.push(...n),0!==n.length);t++);return d(i)}function ct(t,e){const s=t.taskTicks||[];let i=0,n=s.length-1;for(;n-i>1;){const t=Math.floor((n-i)/2)+i;s[t].x<e?i=t:n=t}return Math.abs(s[i].x-e)<Math.abs(s[n].x-e)?s[i]:s[n]}function ut(t,s){return(t||[]).length!==(s||[]).length||0!==(t||[]).length&&(t||[]).some((t,i)=>function(t,s){const i=gt(t);return X.some(t=>{const n=["start","end"].includes(t),o=n?A(i[t]):i[t],h=n?A(s[t]):s[t];return(!e(o)||!e(h))&&(n?o.getTime()!==h.getTime():a(o)||a(h)?(d=(o||[]).map(t=>t||""),l=(h||[]).map(t=>t||""),!((d||[]).length===(l||[]).length&&0===r(d,l).length)):(o||"")!==(h||""));var d,l})}(t,s[i]))}function gt(t,e){const s=e||t.taskId,i=d((t.dependencies||[]).map(t=>t.split("_")[0])),n=d((t.allowedDependencies||[]).map(t=>t.split("_")[0]));return{id:s,name:t.name,progress:t.progress,start:t.start,end:t.end,swimlanes:t.swimlanes,editable:t.editable,startDrag:t.startDrag,endDrag:t.endDrag,textColor:t.textColor,barColor:t.barColor,progressColor:t.progressColor,progressDrag:t.progressDrag,dependencies:i,allowedDependencies:n,metadata:t.metadata}}function mt(e,s){let{minDate:i,maxDate:n}=e.reduce((t,e)=>((!t.minDate||t.minDate.getTime()>e.startDate.getTime())&&(t.minDate=e.startDate),(!t.maxDate||t.maxDate.getTime()<e.endDate.getTime())&&(t.maxDate=e.endDate),t),{minDate:null,maxDate:null});const r=function(e){switch(e){case t.GanttMode.QuarterDay:case t.GanttMode.HalfDay:case t.GanttMode.Day:return L.Day;case t.GanttMode.Week:case t.GanttMode.Month:return L.Month;case t.GanttMode.Year:return L.Year}}(s.viewMode);i&&n?(i=G(i,r),n=G(n,r)):(i=G(F(),r),n=j(i,1,L.Month));const{value:a,scale:o}=et(s.viewMode);return{minDate:j(i,-a,o),maxDate:j(n,a,o)}}const ft=["grid-row","row-line","tick","today-highlight"];class pt{constructor(t){this.gantt=t,this.gridRowsElements=[],this.gridLinesElements=[],this.gridTicksElements=[]}render(){this.renderGridBackground(),this.renderGridRows(),this.renderGridHeader(),this.renderGridTicks(),this.renderGridHighlights(),this.renderDates()}renderGridBackground(){this.gridBackgroundElement=u("rect",{x:0,y:0,width:this.gantt.settings.tableWidth,height:st(this.gantt.settings),class:"grid-background"},this.gantt.layers.grid)}renderGridRows(){const t=u("g",{},this.gantt.layers.grid),e=u("g",{},this.gantt.layers.grid);let s=this.gantt.settings.headerHeight;for(let i=0;i<this.gantt.settings.numberRows;i++){const n=this.gantt.settings.rowHeights[i]||this.gantt.settings.defaultRowHeight;this.gridRowsElements[i]=u("rect",{x:0,y:s,width:this.gantt.settings.rowWidth,height:n,class:"grid-row"},t),this.gridLinesElements[i]=u("line",{x1:0,y1:s+n,x2:this.gantt.settings.rowWidth,y2:s+n,class:"row-line"},e),s+=n}}renderGridHeader(){const t=this.gantt.settings.headerHeight;u("rect",{x:0,y:0,width:this.gantt.settings.rowWidth,height:t,class:"grid-header"},this.gantt.layers.grid)}renderGridTicks(){let t=0,e=this.gantt.settings.headerHeight;const s=it(0,this.gantt.settings.rowHeights);for(let i of this.gantt.settings.dates){if(t>0){let n="tick";this.isTickThick(i)&&(n+=" thick");const r=u("rect",{x:t,y:e,height:s,class:n},this.gantt.layers.grid);this.gridTicksElements.push(r)}t+=q(this.gantt.options,i)}}renderGridHighlights(){if(![t.GanttMode.QuarterDay,t.GanttMode.HalfDay,t.GanttMode.Day,t.GanttMode.Week].includes(this.gantt.options.viewMode))return;const e=N(F(),this.gantt.settings.minDate,L.Hour)/this.gantt.settings.hoursStep*q(this.gantt.options),s=q(this.gantt.options)/Q(this.gantt.options.viewMode),i=it(this.gantt.settings.headerHeight,this.gantt.settings.rowHeights);this.gridHighlightElement=u("rect",{x:e,y:0,width:s,height:i,class:"today-highlight"},this.gantt.layers.grid)}isTickThick(e){switch(this.gantt.options.viewMode){case t.GanttMode.Day:return 1===e.getDate();case t.GanttMode.Week:return e.getDate()>=1&&e.getDate()<8;case t.GanttMode.Month:return e.getMonth()%3==0;default:return!1}}renderDates(){var t;for(let e of this.getDatesToDraw()){u("text",{x:e.lower.x,y:e.lower.y,class:"lower-text"},this.gantt.layers.date,e.lower.text);const s=this.gantt.layers.grid.getBoundingClientRect();(null===(t=e.upper)||void 0===t?void 0:t.x)<s.width&&u("text",{x:e.upper.x,y:e.upper.y,class:"upper-text"},this.gantt.layers.date,e.upper.text)}}getDatesToDraw(){let e=null,s=0;return this.gantt.settings.dates.map((i,n)=>{const r=this.getComputedOptions(i),a=function(e,s,i,n,r){const a={x:r,lowerY:n.headerHeight-n.padding/2,upperY:n.headerHeight/2-n.padding/2};let o=null,h=null,d=0,l=0;switch(n.viewMode){case t.GanttMode.QuarterDay:o="HH",h=s&&e.getDate()===s.getDate()?"":i%16==0?"D MMM YYYY":"D MMM",d=0===i?n.columnWidth/4:0,l=2*n.columnWidth;break;case t.GanttMode.HalfDay:o="HH",h=s&&e.getDate()===s.getDate()?"":i%8==0?"D MMM YYYY":"D MMM",d=0===i?n.columnWidth/4:0,l=n.columnWidth;break;case t.GanttMode.Day:o="D",h=s&&e.getMonth()===s.getMonth()?"":"MMMM YYYY",d=n.columnWidth/2,l=n.columnWidth*(I(e)-2)/2;break;case t.GanttMode.Week:o=s&&e.getMonth()===s.getMonth()?"D":"D MMM",h=s&&e.getMonth()===s.getMonth()?"":"MMMM YYYY",d=0===i?n.columnWidth/8:0,l=2*n.columnWidth;break;case t.GanttMode.Month:o="MMMM",h=i%3==0?"YYYY":"",d=n.columnWidth/2,l=n.columnWidth/2;break;case t.GanttMode.Year:o="YYYY",d=n.columnWidth/2}const c=o&&U(e,o),u=h&&U(e,h);return{upper:u&&{text:u,y:a.upperY,x:a.x+l},lower:{text:c,y:a.lowerY,x:a.x+d}}}(i,e,n,r,s);return s+=r.columnWidth,e=i,a})}getComputedOptions(t){return Object.assign(Object.assign({},this.gantt.options),{columnWidth:q(this.gantt.options,t),headerHeight:this.gantt.settings.headerHeight})}onLineResized(t,e){this.updatePositions(t)}updatePositions(t){const e=it(this.gantt.settings.headerHeight,this.gantt.settings.rowHeights);g(this.gridBackgroundElement,{height:e}),this.gridHighlightElement&&g(this.gridHighlightElement,{height:e}),this.gridTicksElements.forEach(t=>g(t,{height:e}));let s=this.gantt.settings.headerHeight;for(let e=0;e<this.gantt.settings.numberRows;e++){const i=this.gantt.settings.rowHeights[e]||this.gantt.settings.defaultRowHeight;e>=t&&(g(this.gridRowsElements[e],{y:s,height:i}),g(this.gridLinesElements[e],{y1:s+i,y2:s+i})),s+=i}}handleDragStart(t){this.rowHeightsDrag=i(this.gantt.settings.rowHeights)}handleDragEnd(t){this.rowHeightsDrag=null}onKeyUp(t){"Escape"===t.key&&this.onEscapeKeyUp()}onEscapeKeyUp(){if(this.rowHeightsDrag){const t=this.rowHeightsDrag.findIndex((t,e)=>t!==this.gantt.settings.rowHeights[e]);-1!==t&&(this.gantt.settings.rowHeights=i(this.rowHeightsDrag),this.updatePositions(t))}}isTaskGridElement(t){return ft.some(e=>t.classList.contains(e))}}class vt{constructor(t,e,s,i){this.task=t,this.yPosition=e,this.gantt=s,this.barsSvgs=i,this.fromArrowsSvgs=[],this.toArrowsSvgs=[],this.draggingVertically=!1,this.sideHandlesOverflowing=!1,this.x1=K(this.gantt.options,this.gantt.settings,this.task.startDate),this.x2=K(this.gantt.options,this.gantt.settings,this.task.endDate),this.y=this.yPosition+this.gantt.options.padding/2,this.height=this.gantt.options.barHeight,this.progress=this.task.progress,this.parentSvg=this.barsSvgs}get id(){return this.task.id}get barWidth(){return Math.max(this.x2-this.x1,1)}get width(){return this.barWrapperElement.getBBox().width}get x(){return this.x1}get getY(){return this.y}get getHeight(){return this.height}get startX(){return this.barWrapperElement.getBBox().x}get endX(){return this.startX+this.width}get startEndpointCX(){return this.x1-10}get startEndpointCY(){return this.y+this.height/2}get endEndpointCX(){return this.x2+10}get endEndpointCY(){return this.startEndpointCY}get parent(){return this.parentSvg}progressChanged(){return s(this.progressDrag)&&this.progress!==this.progressDrag}parentChanged(){return s(this.parentSvgDrag)&&this.parentSvg!==this.parentSvgDrag}datesChanged(){return s(this.x1Drag)&&this.x1!==this.x1Drag||s(this.x2Drag)&&this.x2!==this.x2Drag}setFromArrows(t){this.fromArrowsSvgs=t,this.checkArrowsEndpoints()}addFromArrows(t){this.fromArrowsSvgs||(this.fromArrowsSvgs=[]),this.fromArrowsSvgs.push(...t),this.checkArrowsEndpoints()}addToArrow(t){this.toArrowsSvgs||(this.toArrowsSvgs=[]),this.toArrowsSvgs.push(t),this.checkArrowsEndpoints()}removeFromArrow(t){const e=this.getFromArrowIndex(t);if(-1!==e){this.fromArrowsSvgs[e].destroy(),this.fromArrowsSvgs.splice(e,1)}this.checkArrowsEndpoints()}getFromArrowIndex(t){return(this.fromArrowsSvgs||[]).findIndex(e=>e.fromBar===this&&e.toBar===t)}removeToArrow(t){const e=this.getToBarArrowIndex(t);if(-1!==e){this.toArrowsSvgs[e].destroy(),this.toArrowsSvgs.splice(e,1)}this.checkArrowsEndpoints()}getToBarArrowIndex(t){return(this.toArrowsSvgs||[]).findIndex(e=>e.fromBar===t&&e.toBar===this)}setArrowActive(t,e){const s=this.getFromArrowIndex(t);-1!==s&&(e?this.fromArrowsSvgs[s].setActive():this.fromArrowsSvgs[s].removeActive())}render(){this.renderBarWrappers(),this.renderElements()}renderElements(){this.renderBar(),this.renderProgress(),this.renderText(),this.renderEndpoints(),this.renderResizeHandles()}renderBarWrappers(){this.barWrapperElement=u("g",{class:"bar-wrapper",id:this.task.id},this.gantt.layers.bar);const t=u("g",{class:"bar-group-wrapper"},this.barWrapperElement);this.barGroupElement=u("g",{class:"bar-group"},t)}renderBar(){const t=this.x1,e=this.y,s=this.barWidth,i=this.height;this.barElement?g(this.barElement,{x:t,y:e,width:s,height:i}):(this.barElement=u("rect",{x:t,y:e,width:s,height:i,rx:this.gantt.options.barCornerRadius,ry:this.gantt.options.barCornerRadius,class:"bar",style:this.task.barColor?"fill:"+this.task.barColor:""},this.barGroupElement),k(this.barElement,"width",0,s))}renderProgress(){const t=this.barWidth*this.progress/100,e=Math.min(this.barWidth,t),s=this.x1,i=this.y,n=this.height;this.progressElement?g(this.progressElement,{x:s,y:i,height:n,width:t}):(this.progressElement=u("rect",{x:s,y:i,width:t,height:n,rx:this.gantt.options.barCornerRadius,ry:this.gantt.options.barCornerRadius,class:"bar-progress",style:(this.task.progressColor?"fill:"+this.task.progressColor+"; ":"")+"opacity: 0.5"},this.barGroupElement),k(this.progressElement,"width",0,t)),this.progressInnerElement?g(this.progressInnerElement,{x:s,y:i,height:n,width:e}):(this.progressInnerElement=u("rect",{x:s,y:i,width:e,height:n,rx:this.gantt.options.barCornerRadius,ry:this.gantt.options.barCornerRadius,class:"bar-progress",style:this.task.progressColor?"fill:"+this.task.progressColor+"; ":""},this.barGroupElement),k(this.progressInnerElement,"width",0,e))}renderText(){const t=this.x1+this.barWidth/2,e=this.y+this.height/2;this.textElement?g(this.textElement,{x:t,y:e}):this.textElement=u("text",{x:t,y:e,style:this.task.textColor?`fill: ${this.task.textColor};`:"",class:"bar-label"},this.barGroupElement,this.task.name),this.updateLabelPosition()}updateLabelPosition(){this.textElement.getBoundingClientRect().width>this.barWidth?(this.textElement.classList.add("big"),m(this.textElement,"x",String(this.x2+20))):(this.textElement.classList.remove("big"),m(this.textElement,"x",String(this.x1+this.barWidth/2)))}renderResizeHandles(){this.renderBarResizeHandles(),this.renderProgressResizeHandle()}renderBarResizeHandles(){if(this.isDraggableLeft()){const t=this.x1+1,e=this.y+1,s=10,i=this.height-2;this.handleLeftElement?g(this.handleLeftElement,{x:t,y:e,width:s,height:i}):this.handleLeftElement=u("rect",{x:t,y:e,width:s,height:i,rx:this.gantt.options.barCornerRadius,ry:this.gantt.options.barCornerRadius,class:"bar-handle left"},this.barGroupElement)}if(this.isDraggableRight()){const t=this.x1+this.barWidth-1-10,e=this.y+1,s=10,i=this.height-2;this.handleRightElement?g(this.handleRightElement,{x:t,y:e,width:s,height:i}):this.handleRightElement=u("rect",{x:t,y:e,width:s,height:i,rx:this.gantt.options.barCornerRadius,ry:this.gantt.options.barCornerRadius,class:"bar-handle right"},this.barGroupElement)}}isDraggableLeft(){return this.task.editable&&this.task.startDrag&&this.gantt.options.resizeTaskLeft}isDraggableRight(){return this.task.editable&&this.task.endDrag&&this.gantt.options.resizeTaskRight}isProgressDraggable(){return this.task.editable&&this.task.progressDrag&&this.gantt.options.resizeProgress&&s(this.progress)}renderProgressResizeHandle(){if(this.isProgressDraggable()){this.handleProgressGroup||(this.handleProgressGroup=u("g",{class:"bar-handle-progress-group"},this.barGroupElement));const t=this.getProgressPolygonPoints().join(",");this.handleProgressElement?g(this.handleProgressElement,{points:t}):this.handleProgressElement=u("polygon",{points:t,class:"bar-handle progress"},this.handleProgressGroup);const e=_(this.progressElement),s=4,i=function(t,e,s=3){const{height:i}=D(s);return`M${t} ${e-i} ${[["c",1.1,0,2.2,.5,3,1.3],["c",.8,.9,1.3,1.9,1.3,3.1],["s",-.5,2.5,-1.3,3.3],["l",-3,3.1],["l",-3,-3.1],["c",-.8,-.8,-1.3,-2,-1.3,-3.3],["c",0,-1.2,.4,-2.2,1.3,-3.1],["c",.8,-.8,1.9,-1.3,3,-1.3]].reduce((t,e)=>`${t} ${e.map(t=>o(t)?(h(t)*s).toFixed(1):t).join(" ")}`,"")} Z`}(e,this.y,s);this.handleProgressMarkerElement?m(this.handleProgressMarkerElement,"d",i):this.handleProgressMarkerElement=u("path",{d:i,class:"progress-marker",display:"none"},this.handleProgressGroup);const n=this.progress>999?String("999+"):String(this.progress),{height:r}=D(s),a=this.y-r/2-s;this.handleProgressTextElement?(g(this.handleProgressTextElement,{x:e,y:a}),this.handleProgressTextElement.innerHTML=n):this.handleProgressTextElement=u("text",{x:e,y:a,class:"bar-label",display:"none"},this.handleProgressGroup,n)}}getProgressPolygonPoints(){const t=Math.sqrt(Math.pow(10,2)-Math.pow(5,2)),e=(s=this.progressElement,+(null===(i=s)||void 0===i?void 0:i.getAttribute("y")));var s,i;const n=_(this.progressElement),r=function(t){var e;return+(null===(e=t)||void 0===e?void 0:e.getAttribute("height"))}(this.progressElement);return[n-5,e+r,n+5,e+r,n,e+r-t]}renderEndpoints(){if(!this.hasAnyDependencies())return;let t=this.startEndpointCX;const e=this.startEndpointCY;this.endpointStartElement?g(this.endpointStartElement,{cx:t,cy:e,r:5}):this.endpointStartElement=u("circle",{cx:t,cy:e,r:5,class:"endpoint start"},this.barGroupElement),t=this.endEndpointCX,this.endpointEndElement?(g(this.endpointEndElement,{cx:t,cy:e,r:5}),this.checkEndpointEndClickListener()):(this.endpointEndElement=u("circle",{cx:t,cy:e,r:5,class:"endpoint end"},this.barGroupElement),this.checkEndpointEndClickListener())}checkEndpointEndClickListener(){const t=this.task.editable&&this.hasPossibleDependencies();t&&!this.endpointEndClickListener?(this.endpointEndClickListener=()=>this.onEndpointEndClick(),this.endpointEndElement.addEventListener("click",this.endpointEndClickListener),this.endpointEndElement.classList.add("clickable")):!t&&this.endpointEndClickListener&&(this.endpointEndElement.removeEventListener("click",this.endpointEndClickListener),this.endpointEndClickListener=null,this.endpointEndElement.classList.remove("clickable"))}onEndpointEndClick(){var t;this.gantt.preventEventListeners||(null===(t=this.endpointEndElement)||void 0===t||t.classList.add("active"),this.gantt.createDragArrow(this))}onCreateArrowDestroyed(){var t;null===(t=this.endpointEndElement)||void 0===t||t.classList.remove("active")}hasAnyDependencies(){return[...this.task.allowedDependencies||[],...this.task.dependencies||[]].length>0}hasPossibleDependencies(){const t=r(this.task.allowedDependencies,this.task.dependencies);return r(t,this.task.parentDependencies).length>0}handleDragStart(t){t===this.handleProgressElement&&function(...t){t.forEach(t=>p(t))}(this.handleProgressTextElement,this.handleProgressMarkerElement),t!==this.handleLeftElement&&t!==this.handleRightElement||(this.sideHandlesOverflowing=w(this.handleRightElement)<=w(this.handleLeftElement)+y(this.handleLeftElement)),this.x1Drag=this.x1,this.x2Drag=this.x2,this.progressDrag=this.progress,this.yDrag=this.y,this.parentSvgDrag=this.parentSvg,this.draggingVertically=!1,[...this.fromArrowsSvgs,...this.toArrowsSvgs].forEach(e=>e.handleDragStart(t))}handleDrag(t,e,s,i,n){if(t===this.handleLeftElement||t===this.handleRightElement)this.sideHandlesOverflowing?(this.assignHandleOverflowElement(e),this.handleOverflowElement===this.handleRightElement?this.resizeRight(e,i):this.handleOverflowElement===this.handleLeftElement&&this.resizeLeft(e,i)):t===this.handleLeftElement?this.resizeLeft(e,i):t===this.handleRightElement&&this.resizeRight(e,i);else if(t===this.handleProgressElement)this.resizeProgress(e,i);else if(this.task.editable){c(".bar-wrapper",t)===this.barWrapperElement&&this.dragWrapper(e,s,i,n)}}assignHandleOverflowElement(t){this.handleOverflowElement||(t>0?this.handleOverflowElement=this.handleRightElement:t<0&&(this.handleOverflowElement=this.handleLeftElement))}resizeLeft(t,e,s=!0){if(0===t||!this.isDraggableLeft())return;const i=this.x1;if(this.x1Drag+e<this.x2){const n=ct(this.gantt.settings,this.x1Drag+e);if(t>0&&n.x<this.x1)return;if(t<0&&n.x>this.x1)return;if(this.x1!==n.x&&this.x2-n.x>1){const t=n.x-this.x1;this.x1=n.x,this.checkBarPosition(i,this.x2),s&&(this.updatePositions(),this.emitBarDragging(t,0))}}}updatePositions(){this.renderElements(),this.updateTaskData()}resizeRight(t,e,s=!0){if(0!==t&&this.isDraggableRight()&&this.x2Drag+e>this.x1){const i=ct(this.gantt.settings,this.x2Drag+e);if(t>0&&i.x<this.x2)return;if(t<0&&i.x>this.x2)return;if(this.x2!==i.x&&i.x-this.x1>1){const t=i.x-this.x2;this.x2=i.x,s&&(this.updatePositions(),this.emitBarDragging(0,t))}}}resizeProgress(t,s){if(0===t||!this.isProgressDraggable())return;const i=s+this.barWidth*this.progressDrag/100,n=Math.max(Math.round(i/this.barWidth*100),0),r=this.checkProgressByRange(n,t);if(!e(r)&&(t>0&&r>this.progress||t<0&&r<this.progress)){const t=r-this.progress;this.progress=r,this.updateProgressPosition(),this.emitProgressDragging(t)}}checkProgressByRange(t,e){const i=s(this.task.minProgress)?this.task.minProgress:0,n=s(this.task.maxProgress)?this.task.maxProgress:Number.MAX_SAFE_INTEGER;if(t>=i&&t<=n)return t;if(e>0){if(t<i)return t;if(t>n)return n}else if(e<0){if(t>n)return t;if(t<i)return i}return null}updateProgressPosition(){this.task.progress=this.progress,this.renderProgress(),this.renderProgressResizeHandle()}emitProgressDragging(t){this.gantt.linesSvg.onBarProgressDragging(this,t),(this.parentSvg||this.barsSvgs).onBarDragging(this,!0)}dragWrapper(t,e,s,i){if(this.draggingVertically=this.dragBarVertical(e,i)||this.draggingVertically,t<0){const e=this.x1;this.resizeLeft(t,s,!1);const i=this.x1-e;0!==i&&(this.x2+=i,this.updatePositions(),this.emitBarDragging(i,i,this.draggingVertically))}else if(t>0){const e=this.x2;this.resizeRight(t,s,!1);const i=this.x2-e;0!==i&&(this.x1+=i,this.updatePositions(),this.emitBarDragging(i,i,this.draggingVertically))}else this.isDraggableVertically()&&(this.updateTaskData(),this.emitBarDragging(0,0,this.draggingVertically))}dragBarVertical(t,e){return!(!this.isDraggableVertically()||0===t)&&this.gantt.linesSvg.handleVerticalDragBar(this,t,this.yDrag+e)}isDraggableVertically(){return this.gantt.containsSwimLanes&&this.gantt.options.dragTaskSwimlanes}emitBarDragging(t,e,s){this.gantt.linesSvg.onBarDragging(this,t,e),(this.parentSvg||this.barsSvgs).onBarDragging(this,s),this.updateArrows()}checkArrowsEndpoints(){this.endpointEndElement&&this.checkEndpointEndClickListener()}updateArrows(){this.fromArrowsSvgs.forEach(t=>t.updatePosition()),this.toArrowsSvgs.forEach(t=>t.updatePosition()),this.checkArrowsEndpoints()}handleDragEnd(t){[...this.fromArrowsSvgs,...this.toArrowsSvgs].forEach(e=>e.handleDragEnd(t)),this.x1Drag=null,this.x2Drag=null,this.progressDrag=null,this.yDrag=null,this.parentSvgDrag=null,this.draggingVertically=!1,this.handleOverflowElement=null,this.sideHandlesOverflowing=!1,function(...t){t.forEach(t=>v(t))}(this.handleProgressTextElement,this.handleProgressMarkerElement),this.updateTaskData()}updateTaskData(){this.task.startDate=J(this.gantt.options,this.gantt.settings,this.x1),this.task.start=U(this.task.startDate,this.gantt.options.dateFormat),this.task.endDate=J(this.gantt.options,this.gantt.settings,this.x2),this.task.end=U(this.task.endDate,this.gantt.options.dateFormat),this.task.progress=this.progress,this.task.swimlanes=this.parent.swimlaneObjects}dragBar(t,e){const s=this.isDraggableLeft()?t:0,i=this.isDraggableRight()?e:0;if(0!==s||0!==i){const t=this.x1,e=this.x2;this.x1+=s,this.x2+=i,this.checkBarPosition(t,e),this.updatePositions(),this.updateArrows()}}dragProgress(t){this.isProgressDraggable()&&(this.progress=Math.max(this.progress+t,0),this.updateProgressPosition())}checkBarPosition(t,e){if(this.gantt.options.lockResize){const s=this.gantt.tasks.filter(t=>this.task.parentTransitiveDependencies.includes(t.id)).reduce((t,e)=>Math.max(t,K(this.gantt.options,this.gantt.settings,e.startDate)),0);if(this.x1<s)if(t>=s){const t=s-this.x1;this.x1+=t,this.x2!==e&&(this.x2+=t)}else t>this.x1&&(this.x1=t,this.x2!==e&&(this.x2=e))}}onKeyUp(t){[...this.fromArrowsSvgs,...this.toArrowsSvgs].forEach(e=>e.onKeyUp(t)),"Escape"===t.key&&this.onEscapeKeyUp()}onEscapeKeyUp(){let t=!1;s(this.x1Drag)&&(this.x1=this.x1Drag,this.x1Drag=null,t=!0),s(this.x2Drag)&&(this.x2=this.x2Drag,this.x2Drag=null,t=!0),s(this.progressDrag)&&(this.progress=this.progressDrag,this.progressDrag=null,t=!0),s(this.yDrag)&&(this.y=this.yDrag,this.yDrag=null,t=!0),s(this.parentSvgDrag)&&(this.parentSvg=this.parentSvgDrag,this.parentSvgDrag=null,this.task.swimlanes=this.parentSvg.swimlaneObjects),t&&this.updatePositions()}onDoubleClick(t){c(".bar-wrapper",t)===this.barWrapperElement&&this.gantt.onTaskDoubleClick(gt(this.task))}setYPosition(t){this.y!==t&&(this.y=t,this.updatePositions(),this.updateArrows())}moveYPosition(t){this.setYPosition(this.y+t)}setYPositionWithParent(t,e){this.isDraggableVertically()&&(this.parentSvg=t,this.setYPosition(e))}}class wt{constructor(t,e,s,i){this.tasks=t,this.yPosition=e,this.gantt=s,this.swimlanes=i,this.barLinesSvgs=[],this.y=e}get barSvgs(){return this.reduceBarSvgs(this.barLinesSvgs)}get height(){const t=Math.max(this.barLinesSvgs.length,1);return t*this.gantt.options.barHeight+(t+1)*this.gantt.options.padding/2}get getY(){return this.y}get swimlaneObjects(){return(this.swimlanes||[]).map(t=>{var e,s,i;return{value:null===(e=t)||void 0===e?void 0:e.value,title:null===(s=t)||void 0===s?void 0:s.title,data:null===(i=t)||void 0===i?void 0:i.data}})}reduceBarSvgs(t){return(t||[]).reduce((t,e)=>(t.push(...e),t),[])}render(){this.barLinesSvgs=[];for(const t of this.tasks||[]){const e=new vt(t,this.y,this.gantt,this);e.render(),this.checkBarPosition(e)}}checkBarPosition(t,e=0){const s=this.taskOverflowLine(this.barLinesSvgs,t.startX,t.endX,e),i=this.computeYBarPositionForLine(s);t.setYPosition(i),this.barLinesSvgs[s]||(this.barLinesSvgs[s]=[]),this.barLinesSvgs[s].push(t)}computeYBarPositionForLine(t){return this.y+t*this.gantt.options.barHeight+(t+1)*this.gantt.options.padding/2}computeLineForYBarPosition(t){const e=Math.round((t-this.y-this.gantt.options.padding-2)/(this.gantt.options.barHeight+this.gantt.options.padding/2));return Math.max(e,0)}taskOverflowLine(t,e,s,i){if(0===t.length)return i;for(let n=i;n<t.length;n++)if(!this.barOverflowsWithBars(t[n],e,s))return n;return Math.max(i,t.length)}barOverflowsWithBars(t,e,s){for(let i=0;i<(t||[]).length;i++){const n=t[i];if(this.barOverflowsWithBar(e,s,n.startX,n.endX))return!0}return!1}barOverflowsWithBar(t,e,s,i){return t>=s&&t<=i||e>=s&&e<=i||s>=t&&s<=e||i>=t&&i<=e}handleDragStart(t){this.barSvgs.forEach(e=>e.handleDragStart(t)),this.barLinesSvgsDrag=n(this.barLinesSvgs),this.yDrag=this.y}handleDrag(t,e,s,i,n){this.barSvgs.forEach(r=>r.handleDrag(t,e,s,i,n))}handleDragEnd(t){this.barSvgs.forEach(e=>e.handleDragEnd(t)),this.barLinesSvgsDrag=null,this.yDrag=null}dragBars(t,e,s){this.barSvgs.filter(e=>t.includes(e.id)).forEach(t=>t.dragBar(e,s))}onKeyUp(t){this.barSvgs.forEach(e=>e.onKeyUp(t)),"Escape"===t.key&&this.onEscapeKeyUp()}onEscapeKeyUp(){this.barLinesSvgsDrag&&(this.barLinesSvgs=n(this.barLinesSvgsDrag),this.barLinesSvgsDrag=null),this.yDrag&&(this.y=this.yDrag,this.yDrag=null)}onDoubleClick(t){this.barSvgs.forEach(e=>e.onDoubleClick(t))}onBarDragging(t,e){const s=this.barLinesSvgs.findIndex(e=>(e||[]).some(e=>e.id===t.id)),i=[...this.barLinesSvgs].map(e=>[...e||[]].filter(e=>e.id!==t.id));let n;if(e)n=s;else{const e=this.taskOverflowLine(i,t.startX,t.endX,0);n=Math.min(s,e)}const r=this.computeYBarPositionForLine(n);t.setYPosition(r);const a=this.height,o=this.reduceBarSvgs(i);this.barLinesSvgs=[],this.barLinesSvgs[n]=[t],o.forEach(t=>this.checkBarPosition(t)),a!==this.height&&this.gantt.linesSvg.onLineResized(this,this.height-a)}moveYPosition(t){this.barSvgs.forEach(e=>e.moveYPosition(t)),this.y+=t}onNewBarDragging(t,e,s){const i=this.computeLineForYBarPosition(s),r=this.height,a=n(this.barLinesSvgs);this.barLinesSvgs=[];for(let s=0;s<a.length;s++)s<i?this.barLinesSvgs[s]=a[s]:(a[s]||[]).forEach(n=>{const r=this.barOverflowsWithBar(t,e,n.startX,n.endX);let a=0;if(s===i)a=r?s+1:s;else{const t=this.taskOverflowLine(this.barLinesSvgs,n.startX,n.endX,i);a=t!==i||r?t!==i?t:this.taskOverflowLine(this.barLinesSvgs,n.startX,n.endX,s):i}const o=this.computeYBarPositionForLine(a);n.setYPosition(o),this.barLinesSvgs[a]||(this.barLinesSvgs[a]=[]),this.barLinesSvgs[a].push(n)});r!==this.height&&this.gantt.linesSvg.onLineResized(this,this.height-r)}getNewBarYPosition(t){for(let e=0;e<(this.barLinesSvgs||[]).length;e++){const s=0===e?this.y:this.computeYBarPositionForLine(e)-this.gantt.options.padding/4,i=e===this.barLinesSvgs.length-1?this.y+this.height:this.computeYBarPositionForLine(e+1)-this.gantt.options.padding/4;if(t>=s&&t<=i)return this.computeYBarPositionForLine(e)}return this.computeYBarPositionForLine(0)}someBarOverflows(t,e){return this.barSvgs.some(s=>t.id!==s.id&&s.getY===e&&this.barOverflowsWithBar(t.startX,t.endX,s.startX,s.endX))}getNextLineY(t){const e=this.computeLineForYBarPosition(t);return this.computeYBarPositionForLine(e+1)}createBarSvg(t,e){t.swimlanes=this.swimlaneObjects;const s=new vt(t,e-this.gantt.options.padding/2,this.gantt,this);s.render(),this.addBarSvg(s,e),this.gantt.linesSvg.barSvgsMap[t.id]=s,this.gantt.onTaskCreated(gt(t,t.id))}addBarSvg(t,e){const s=this.computeLineForYBarPosition(e),i=this.height;this.barLinesSvgs[s]?this.barLinesSvgs[s].push(t):this.barLinesSvgs[s]=[t],i!==this.height&&this.gantt.linesSvg.onLineResized(this,this.height-i)}removeBarSvg(t,e=!0){const s=this.height;for(let e=0;e<this.barLinesSvgs.length;e++)this.barLinesSvgs[e]&&(this.barLinesSvgs[e]=this.barLinesSvgs[e].filter(e=>e.id!==t.id));if(e){const t=[...this.barSvgs];this.barLinesSvgs=[],t.forEach(t=>this.checkBarPosition(t)),e&&s!==this.height&&this.gantt.linesSvg.onLineResized(this,this.height-s)}}updateBarSvgLine(t,e){this.removeBarSvg(t,!1),this.addBarSvg(t,e)}}class yt{constructor(t,e,s,i){this.gantt=t,this.swimlanesSvg=e,this.rectElements=[],this.textElements=[],this.textBackgroundElements=[],this.textImageElements=[],this.swimlanes=[],this.heights=[],this.ys=[],this.width=s,this.x=i}get handleX(){return this.x+this.width-5}get avatarSize(){return this.gantt.options.avatarSize}get avatarPadding(){return this.gantt.options.avatarPadding}get checkboxSize(){return this.gantt.options.checkboxSize}renderCell(e,s,i,n,r,a){var o,h,d,l,c,m,p,v,w,y;if(this.swimlanes[s]=e,r)this.rectElements[s]=this.rectElements[s-1],this.textElements[s]=this.textElements[s-1],this.textBackgroundElements[s]=this.textBackgroundElements[s-1],this.textImageElements[s]=this.textImageElements[s-1],this.rectElements[s]&&f(this.rectElements[s],"height",i),this.textElements[s]&&f(this.textElements[s],"y",i/2),this.textBackgroundElements[s]&&f(this.textBackgroundElements[s],"y",i/2),this.textImageElements[s]&&f(this.textImageElements[s],"y",i/2);else{const r=u("g",{id:(null===(o=e)||void 0===o?void 0:o.id)||nt(),class:"swimlane"},this.gantt.layers.swimlanes);if(this.rectElements[s]=u("rect",{x:this.x,y:n,width:this.width,height:i,fill:(null===(h=e)||void 0===h?void 0:h.background)||"white",class:`swimlane-rect ${a||""}`},r),(null===(d=e)||void 0===d?void 0:d.title)||(null===(l=e)||void 0===l?void 0:l.type)===t.GanttSwimlaneType.Checkbox){let a=this.x+this.gantt.options.padding;(null===(c=e)||void 0===c?void 0:c.textBackground)&&(this.textBackgroundElements[s]=u("rect",{x:0,y:0,width:0,height:0,rx:8,ry:8,fill:e.textBackground},r),a+=this.gantt.options.textBackgroundPadding);const o=n+i/2;let h=0,d=0;if((null===(m=e)||void 0===m?void 0:m.type)===t.GanttSwimlaneType.Checkbox)h=this.checkboxSize,d=this.checkboxSize,this.textImageElements[s]=function(t,e,s,i,n){const r=u("svg",{viewBox:"0 0 24 24",width:s,height:s,x:t,y:e},n);return u("path",i?{d:"M10.041 17l-4.5-4.319 1.395-1.435 3.08 2.937 7.021-7.183 1.422 1.409-8.418 8.591zm-5.041-15c-1.654 0-3 1.346-3 3v14c0 1.654 1.346 3 3 3h14c1.654 0 3-1.346 3-3v-14c0-1.654-1.346-3-3-3h-14zm19 3v14c0 2.761-2.238 5-5 5h-14c-2.762 0-5-2.239-5-5v-14c0-2.761 2.238-5 5-5h14c2.762 0 5 2.239 5 5z"}:{d:"M5 2c-1.654 0-3 1.346-3 3v14c0 1.654 1.346 3 3 3h14c1.654 0 3-1.346 3-3v-14c0-1.654-1.346-3-3-3h-14zm19 3v14c0 2.761-2.238 5-5 5h-14c-2.762 0-5-2.239-5-5v-14c0-2.761 2.238-5 5-5h14c2.762 0 5 2.239 5 5z"},r),r}(a,o-this.checkboxSize/2,this.checkboxSize,!!(null===(p=e)||void 0===p?void 0:p.value),r);else{(null===(v=e)||void 0===v?void 0:v.avatarUrl)&&(this.textImageElements[s]=u("image",{x:a,y:o-this.avatarSize/2,width:this.avatarSize,height:this.avatarSize,href:null===(w=e)||void 0===w?void 0:w.avatarUrl,class:"circle-image"},r),h=this.avatarSize+this.avatarPadding,d=this.avatarSize),this.textElements[s]=u("text",{x:a+h,y:o,fill:e.textColor,"dominant-baseline":"middle","text-anchor":"start",class:"swimlane-label"},r,null===(y=e)||void 0===y?void 0:y.title);const t=this.textElements[s].getBoundingClientRect();h+=t.width,d=Math.max(d,t.height)}this.textBackgroundElements[s]&&g(this.textBackgroundElements[s],{x:a-this.gantt.options.textBackgroundPadding,y:o-d/2-this.gantt.options.textBackgroundPadding/2,width:h+2*this.gantt.options.textBackgroundPadding,height:d+this.gantt.options.textBackgroundPadding})}}this.heights[s]=i,this.ys[s]=n}renderHeaderCell(t,e,s){const i=u("g",{class:"swimlane-header"},this.gantt.layers.swimlanes);this.headerRectElement=u("rect",{x:this.x,y:e,width:this.width,height:s,style:t&&t.background?`fill: ${t.background};`:"",class:"swimlane-header-rect"+(t?"":" empty")},i),t&&(this.headerTextElement=u("text",{x:this.x+this.gantt.options.padding,y:e+s/2,"dominant-baseline":"middle","text-anchor":"start",style:t.color?`fill: ${t.color};`:"",class:"swimlane-header-label"},i,t.title)),this.headerY=e,this.headerHeight=s}renderResizeHandle(t,e,s){this.gantt.options.resizeSwimlanes&&(this.handleElement=u("rect",{x:this.handleX,y:s,width:10,height:e,class:"swimlane-resize-handle"},this.gantt.layers.swimlanes),this.handleHeight=e)}handleDragStart(t){this.widthDrag=this.width,this.xDrag=this.x,this.handleHeightDrag=this.handleHeight,this.heightsDrag=i(this.heights),this.ysDrag=i(this.ys)}handleDrag(t,e,s,i,n){if(t===this.handleElement){const t=Math.max(5+2*this.gantt.options.padding,this.widthDrag+i);if(t!==this.width){const e=t-this.width;this.width=t,this.updatePositions(),this.swimlanesSvg.swimlaneResizing(this,e)}}}handleDragEnd(t){this.widthDrag=null,this.xDrag=null,this.handleHeightDrag=null,this.heightsDrag=null,this.ysDrag=null}onKeyUp(t){"Escape"===t.key&&this.onEscapeKeyUp()}onEscapeKeyUp(){let t=!1;this.xDrag&&(this.x=this.xDrag,this.xDrag=null,t=!0),this.widthDrag&&(this.width=this.widthDrag,this.widthDrag=null,t=!0),this.handleHeightDrag&&(this.handleHeight=this.handleHeightDrag,this.handleHeightDrag=null,t=!0),this.heightsDrag&&(this.heights=i(this.heightsDrag),this.heightsDrag=null,t=!0),this.ysDrag&&(this.ys=i(this.ysDrag),this.ysDrag=null,t=!0),t&&this.updatePositions()}updatePositions(){this.rectElements.forEach((t,e)=>{if(t!==this.rectElements[e-1]){const s=this.elementHeight(e);g(t,{x:this.x,width:this.width,height:s,y:this.ys[e]})}}),this.swimlanes.forEach((t,e)=>{if(t!==this.swimlanes[e-1]){let t=this.x+this.gantt.options.padding;this.textBackgroundElements[e]&&(g(this.textBackgroundElements[e],{x:t}),t+=this.gantt.options.textBackgroundPadding),this.textImageElements[e]&&(g(this.textImageElements[e],{x:t}),t+=this.avatarPadding+this.avatarSize),this.textElements[e]&&g(this.textElements[e],{x:t})}}),this.headerRectElement&&g(this.headerRectElement,{x:this.x,width:this.width}),this.headerTextElement&&g(this.headerTextElement,{x:this.x+this.gantt.options.padding}),this.handleElement&&g(this.handleElement,{height:this.handleHeight,x:this.handleX})}elementHeight(t){const e=this.rectElements[t];let s=this.heights[t];for(let i=t+1;i<this.rectElements.length&&this.rectElements[i]===e;i++)s+=this.heights[i];return s}moveXPosition(t){this.x+=t,this.updatePositions()}resizeColumn(t,e){this.heights[t]+=e,this.handleHeight+=e;for(let s=t+1;s<this.ys.length;s++)this.ys[s]+=e;this.updatePositions()}}class _t{constructor(t){this.gantt=t,this.columnsSvgs=[],this.swimlaneWidths=this.computeSwimLaneWidths(),this.swimlaneWidth=this.swimlaneWidths.reduce((t,e)=>t+e,0),this.containsSwimLanes=this.swimlaneWidths.length>0}computeSwimLaneWidths(){const e=u("g",{},this.gantt.layers.swimlanes),s=function(e,s,i){const n=(s||[]).reduce((s,n)=>((n.swimlanes||[]).forEach((n,r)=>{var a,o,h,d,l,c,u;const g=(i.swimlaneInfo||[])[r];let m=0;(null===(a=g)||void 0===a?void 0:a.width)?m=null===(o=g)||void 0===o?void 0:o.width:((null===(h=n)||void 0===h?void 0:h.type)===t.GanttSwimlaneType.Checkbox?m=i.checkboxSize:(null===(d=n)||void 0===d?void 0:d.title)&&(e.innerHTML=n.title,m=e.getBoundingClientRect().width),m>0&&(null===(l=n)||void 0===l?void 0:l.textBackground)&&(m+=2*i.textBackgroundPadding),(null===(c=n)||void 0===c?void 0:c.avatarUrl)&&(m+=i.avatarSize+i.avatarPadding),0===m&&(null===(u=n)||void 0===u?void 0:u.background)&&(m=30),m+=2*i.padding,m=Math.min(m,i.maxInitialSwimlaneWidth)),s[r]=Math.max(s[r]||0,m)}),s),[]);return(i.swimlaneInfo||[]).forEach((t,s)=>{var r,a;if(!(null===(r=t)||void 0===r?void 0:r.width)&&(null===(a=t)||void 0===a?void 0:a.title)){e.innerHTML=t.title;const r=Math.min(e.getBoundingClientRect().width+2*i.padding,i.maxInitialSwimlaneWidth);n[s]=Math.max(n[s]||0,r)}}),n}(u("text",{x:0,y:0,class:"swimlane-label"},e),this.gantt.lines,this.gantt.options);return e.remove(),s}render(){this.containsSwimLanes?this.showSwimLanes():this.hideSwimLanes()}showSwimLanes(){p(this.gantt.layers.swimlanes),this.renderSwimLaneWrappers(),this.renderColumns(),this.renderHeaders(),this.updateWrapperSize()}renderSwimLaneWrappers(){this.swimlaneHeaderElement=u("rect",{x:0,y:0,width:this.swimlaneWidth,height:this.gantt.settings.headerHeight,class:"swimlanes-header"},this.gantt.layers.swimlanes),this.swimlaneBackgroundElement=u("rect",{x:0,y:this.gantt.settings.headerHeight,width:this.swimlaneWidth,height:st(this.gantt.settings)-this.gantt.settings.headerHeight,class:"swimlanes-background"},this.gantt.layers.swimlanes)}hideSwimLanes(){v(this.gantt.layers.swimlanes)}renderColumns(){this.columnsSvgs=[];let t=this.gantt.settings.headerHeight,e=[];this.swimlaneHeight=0,(this.gantt.lines||[]).forEach((s,i)=>{const n=this.gantt.settings.rowHeights[i];this.swimlaneHeight+=n,this.renderSwimLane(s,i,t,n,e),e=s.swimlanes||[],t+=n})}renderSwimLane(t,e,s,i,n){let r=0;for(let a=0;a<(t.swimlanes||[]).length;a++){const o=this.swimlaneWidths[a],h=t.swimlanes[a];this.columnsSvgs[a]||(this.columnsSvgs[a]=new yt(this.gantt,this,o,r));const d=kt(t.swimlanes)?"empty":null,l=n[a]&&h&&n[a].id===h.id;this.columnsSvgs[a].renderCell(h,e,i,s,l,d),r+=o}}renderHeaders(){const t=Math.min(this.gantt.settings.defaultRowHeight,this.gantt.settings.headerHeight),e=this.gantt.settings.headerHeight-t,s=Math.min((this.gantt.options.swimlaneInfo||[]).length,(this.columnsSvgs||[]).length);for(let i=0;i<s;i++){const s=this.gantt.options.swimlaneInfo[i];this.columnsSvgs[i].renderHeaderCell(s,e,t)}const i=st(this.gantt.settings)-this.gantt.settings.headerHeight-(this.swimlaneContainsEmptyLine()?this.gantt.settings.defaultRowHeight:0);for(let e=0;e<s;e++){const s=this.gantt.options.swimlaneInfo[e],n=this.gantt.options.swimlaneInfo[e+1],r=!(!s&&!n),a=this.gantt.settings.headerHeight-(r?t:0),o=i+(r?t:0);this.columnsSvgs[e].renderResizeHandle(r,o,a)}}swimlaneContainsEmptyLine(){const t=this.gantt.lines[this.gantt.lines.length-1];return t&&kt(t.swimlanes||[])}handleDragStart(t){this.columnsSvgs.forEach(e=>e.handleDragStart(t)),this.swimlaneWidthsDrag=i(this.swimlaneWidths),this.swimlaneWidthDrag=this.swimlaneWidth,this.swimlaneHeightDrag=this.swimlaneHeight}handleDrag(t,e,s,i,n){this.columnsSvgs.forEach(r=>r.handleDrag(t,e,s,i,n))}handleDragEnd(t){this.checkWidthResized(),this.columnsSvgs.forEach(e=>e.handleDragEnd(t)),this.swimlaneWidthsDrag=null,this.swimlaneWidthDrag=null,this.swimlaneHeightDrag=null}checkWidthResized(){if(this.swimlaneWidthsDrag){const t=(this.swimlaneWidths||[]).findIndex((t,e)=>this.swimlaneWidthsDrag[e]!==t);if(-1!==t){const e=this.gantt.options.swimlaneInfo&&this.gantt.options.swimlaneInfo[t];e&&(e.width=this.swimlaneWidths[t]),this.gantt.onSwimlaneResized(t,this.swimlaneWidths[t])}}}onKeyUp(t){this.columnsSvgs.forEach(e=>e.onKeyUp(t)),"Escape"===t.key&&this.onEscapeKeyUp()}onEscapeKeyUp(){this.swimlaneWidthDrag&&this.swimlaneWidth!==this.swimlaneWidthDrag&&(this.swimlaneWidth=this.swimlaneWidthDrag,this.swimlaneWidthDrag=null,this.updateWrapperPositions()),this.swimlaneHeightDrag&&this.swimlaneHeight!==this.swimlaneHeightDrag&&(this.swimlaneHeight=this.swimlaneHeightDrag,this.swimlaneHeightDrag=null,this.updateWrapperSize()),this.swimlaneWidthsDrag&&(this.swimlaneWidths=i(this.swimlaneWidthsDrag),this.swimlaneWidthsDrag=null)}swimlaneResizing(t,e){const s=this.columnsSvgs.findIndex(e=>e===t);-1!==s&&(this.swimlaneWidth+=e,this.swimlaneWidths[s]+=e,this.columnsSvgs.slice(s+1).forEach(t=>t.moveXPosition(e)),this.updateWrapperPositions())}updateWrapperPositions(){g(this.swimlaneBackgroundElement,{width:this.swimlaneWidth}),g(this.swimlaneHeaderElement,{width:this.swimlaneWidth}),g(this.gantt.layers.swimlanes,{width:this.swimlaneWidth})}updateWrapperSize(){g(this.gantt.layers.swimlanes,{height:this.swimlaneHeight+this.gantt.settings.headerHeight,width:this.swimlaneWidth}),g(this.swimlaneBackgroundElement,{height:this.swimlaneHeight})}lineResized(t,e){this.swimlaneHeight+=e,this.updateWrapperSize(),this.columnsSvgs.forEach(s=>s.resizeColumn(t,e))}}function kt(e){return e.every(e=>!e||!e.title&&e.type!==t.GanttSwimlaneType.Checkbox&&!e.background)}const Dt=" m -5 -5\n                       l 5 5\n                       l -5 5";function St(t,e,s){const i=t.getY>=e.getY,n=t.getY===e.getY,r=t.endEndpointCX<e.startEndpointCX,a=r?t.endEndpointCX:t.startEndpointCX,o=r?t.endEndpointCY:t.startEndpointCY,h=e.startEndpointCX,d=e.startEndpointCY,l=s.options.arrowCurve,c=i?1:0,u=i?-l:l,g=e.getY+e.getHeight/2-u;if(r)return n?`\n                    M ${a} ${o}\n                    L ${h} ${d}\n                    ${Dt}`:`\n                    M ${a} ${o}\n                    V ${g}\n                    a ${l} ${l} 0 0 ${c} ${l} ${u}\n                    L ${h} ${d}\n                    ${Dt}`;{const i=s.options.barHeight/2+s.options.padding/4-l,r=e.startEndpointCX-2*l;if(n){return`\n                M ${a} ${o}\n                v -${i}\n                a ${l} ${l} 1 0 0 -${l} -${l}\n                H ${r}\n                a ${l} ${l} 0 0 0 -${l} ${l}\n                V ${e.getY+e.getHeight/2-l}\n                a ${l} ${l} 0 0 0 ${l} ${l}\n                L ${h} ${d}\n                ${Dt}`}return`\n                    M ${a} ${o}\n                    H ${Math.min(e.startEndpointCX-2*l,t.startEndpointCX-2*l)}\n                    a ${l} ${l} 0 0 ${c} -${l} ${u}\n                    V ${g}\n                    a ${l} ${l} 0 0 ${c} ${l} ${u}\n                    L ${h} ${d}\n                    ${Dt}`}}class Mt{constructor(t,e,s){this.gantt=t,this.fromBar=e,this.toBar=s}get drawsFromEnd(){return this.fromBar.endEndpointCX<this.toBar.startEndpointCX}get drawsFromStart(){return!this.drawsFromEnd}render(){this.calculatePath(),this.renderElements()}calculatePath(){this.path=St(this.fromBar,this.toBar,this.gantt)}renderElements(){this.arrowElement=this.createElementWithClass("arrow"),this.fromBar.task.editable&&this.toBar.task.editable&&(this.arrowClickableElement=this.createElementWithClass("arrow-clickable"),this.arrowClickListener=t=>this.onArrowClick(t),this.arrowClickableElement.addEventListener("click",this.arrowClickListener))}onArrowClick(t){if(this.deleteIconElement)this.resetArrow();else{if(!this.gantt.preventEventListeners){this.setActive(),this.gantt.linesSvg.setArrowActive(this.fromBar,this.toBar,!0);const e=S(t);this.deleteIconElement=function(t,e,s){const i=u("svg",{viewBox:"0 0 448 512",width:17,height:17,class:"icon-delete",x:t,y:e},s);return u("path",{d:"M32 464\n    a48 48 0 0 0 48 48\n    h288\n    a48 48 0 0 0 48-48\n    V128\n    H32\n    z\n    m272-256\n    a16 16 0 0 1 32 0\n    v224\n    a16 16 0 0 1-32 0\n    z\n    m-96 0\n    a16 16 0 0 1 32 0v224\n    a16 16 0 0 1-32 0\n    z\n    m-96 0\n    a16 16 0 0 1 32 0\n    v224\n    a16 16 0 0 1-32 0\n    z\n    M432 32\n    H312\n    l-9.4-18.7\n    A24 24 0 0 0 281.1 0\n    H166.8\n    a23.72 23.72 0 0 0-21.4 13.3\n    L136 32\n    H16\n    A16 16 0 0 0 0 48\n    v32\n    a16 16 0 0 0 16 16\n    h416\n    a16 16 0 0 0 16-16\n    V48\n    a16 16 0 0 0-16-16z"},i),i}(e.x+10,e.y+5,this.gantt.layers.handle),this.deleteClickListener=()=>this.deleteArrow(),this.deleteIconElement.addEventListener("click",this.deleteClickListener)}setTimeout(()=>{this.documentClickListener=()=>this.resetArrow(),document.addEventListener("click",this.documentClickListener)})}}setActive(){this.arrowElement.classList.contains("active")||this.arrowElement.classList.add("active")}removeActive(){this.arrowElement.classList.remove("active")}resetArrow(){var t,e;null===(t=this.deleteIconElement)||void 0===t||t.removeEventListener("click",this.deleteClickListener),null===(e=this.deleteIconElement)||void 0===e||e.remove(),this.deleteIconElement=null,this.deleteClickListener=null,this.removeActive(),this.gantt.linesSvg.setArrowActive(this.fromBar,this.toBar,!1),document.removeEventListener("click",this.documentClickListener)}deleteArrow(){this.resetArrow(),this.gantt.linesSvg.deleteArrow(this.fromBar,this.toBar)}createElementWithClass(t){return u("path",{d:this.path,class:t},this.gantt.layers.arrow)}updatePosition(){this.calculatePath(),this.updateElements()}updateElements(){this.arrowElement&&m(this.arrowElement,"d",this.path),this.arrowClickableElement&&m(this.arrowClickableElement,"d",this.path)}handleDragStart(t){this.pathDrag=this.path}handleDragEnd(t){this.pathDrag=null}onKeyUp(t){"Escape"===t.key&&this.onEscapeKeyUp()}onEscapeKeyUp(){this.pathDrag&&this.path!==this.pathDrag&&(this.path=this.pathDrag,this.pathDrag=null,this.updateElements())}destroy(){this.arrowElement&&(this.arrowElement.remove(),this.arrowElement=null),this.arrowClickableElement&&(this.arrowClickableElement.remove(),this.arrowClickableElement=null),this.deleteIconElement&&(this.deleteIconElement.remove(),this.deleteIconElement=null),this.arrowClickListener=null,this.deleteClickListener=null,document.removeEventListener("click",this.documentClickListener),this.documentClickListener=null}}class bt{constructor(t){this.gantt=t,this.barsSvgs=[],this.barSvgsMap={}}get containsSwimLanes(){return!!s(this.swimLanesSvg)&&this.swimLanesSvg.containsSwimLanes}render(){this.renderTaskLines(),this.renderArrows(),this.renderSwimLanes()}renderTaskLines(){this.barsSvgs=[],this.barSvgsMap={};let t=this.gantt.settings.headerHeight;(this.gantt.lines||[]).forEach((e,s)=>{const i=this.renderTasksLines(e.tasks,t,e.swimlanes);this.barsSvgs[s]=i,i.barSvgs.forEach(t=>this.barSvgsMap[t.id]=t),t+=i.height,this.gantt.settings.rowHeights[s]=i.height})}renderTasksLines(t,e,s){const i=new wt(t,e,this.gantt,s);return i.render(),i}renderArrows(){Object.values(this.barSvgsMap||{}).forEach(t=>{const e=(t.task.dependencies||[]).map(t=>this.barSvgsMap[t]).filter(t=>!!t);if(e.length){const s=e.map(e=>{const s=new Mt(this.gantt,t,e);return s.render(),e.addToArrow(s),s});t.setFromArrows(s)}})}renderSwimLanes(){this.swimLanesSvg=new _t(this.gantt),this.swimLanesSvg.render()}handleDragStart(t){this.barsSvgs.forEach(e=>e.handleDragStart(t)),this.swimLanesSvg.handleDragStart(t)}handleDrag(t,e,s,i,n){this.barsSvgs.forEach(r=>r.handleDrag(t,e,s,i,n)),this.swimLanesSvg.handleDrag(t,e,s,i,n)}handleDragEnd(t){this.checkTasksChanged(),this.barsSvgs.forEach(e=>e.handleDragEnd(t)),this.swimLanesSvg.handleDragEnd(t)}onBarDragging(t,e,s){const i=(this.gantt.taskIdsMap[t.task.taskId]||[]).filter(e=>e!==t.task.id),n=[...i];if(this.gantt.options.lockResize&&t.task.transitiveDependencies.length){this.barsSvgs.forEach(t=>t.dragBars(i,e,s));const r=[...t.task.transitiveDependencies].filter(t=>!i.includes(t));n.push(...r);const a=e,o=0===e?0:0===s?e:s;this.barsSvgs.forEach(t=>t.dragBars(r,a,o))}else this.barsSvgs.forEach(t=>t.dragBars(i,e,s));this.checkAfterBarDragging(t,n)}checkAfterBarDragging(t,e){this.barsSvgs.forEach(s=>{if(t.parent!==s){const t=s.barSvgs.filter(t=>e.includes(t.id));t.length&&s.onBarDragging(t[0],!1)}})}onBarProgressDragging(t,e){const s=(this.gantt.taskIdsMap[t.task.taskId]||[]).filter(e=>e!==t.task.id);Object.values(this.barSvgsMap||{}).filter(t=>s.includes(t.id)).forEach(t=>t.dragProgress(e)),this.checkAfterBarDragging(t,s)}onKeyUp(t){this.barsSvgs.forEach(e=>e.onKeyUp(t)),this.swimLanesSvg.onKeyUp(t)}onDoubleClick(t){this.barsSvgs.forEach(e=>e.onDoubleClick(t))}onLineResized(t,e){const s=this.barsSvgs.indexOf(t);-1!==s&&(this.gantt.settings.rowHeights[s]=t.height,this.gantt.onLineResized(s,e),this.barsSvgs.slice(s+1).forEach(t=>t.moveYPosition(e)),this.swimLanesSvg.lineResized(s,e))}getSameLockedBars(t){const e=Object.values(this.barSvgsMap||{}).filter(e=>e.task.taskId===t.task.taskId);return e.length?e:[t]}createArrows(t,e){t.forEach(t=>{const s=e.map(e=>{const s=new Mt(this.gantt,t,e);return s.render(),e.task.parentDependencies.push(t.task.id),e.addToArrow(s),s});t.task.dependencies.push(...d(e.map(t=>t.task.id))),t.addFromArrows(s)}),ot(this.gantt.tasksMap),this.gantt.onTaskDependencyAdded(gt(t[0].task),gt(e[0].task))}deleteArrow(t,e){const s=this.getSameLockedBars(t),i=this.getSameLockedBars(e),n=i.map(t=>t.task.id);s.forEach(t=>{t.task.dependencies=t.task.dependencies.filter(t=>!n.includes(t)),i.forEach(e=>{t.removeFromArrow(e),e.task.parentDependencies=e.task.parentDependencies.filter(e=>e!==t.task.id),e.removeToArrow(t)})}),ot(this.gantt.tasksMap),this.gantt.onTaskDependencyRemoved(gt(t.task),gt(e.task))}setArrowActive(t,e,s){const i=this.getSameLockedBars(t),n=this.getSameLockedBars(e);i.forEach(t=>{n.forEach(e=>{t.setArrowActive(e,s)})})}findBarsSvgByY(t){return(this.barsSvgs||[]).find(e=>e.getY<=t&&e.getY+e.height>=t)}handleVerticalDragBar(t,e,s){let i=this.barsSvgs.find((t,e)=>0===e&&s<=t.getY||e===this.barsSvgs.length-1&&s>=t.getY+t.height||t.getY<=s&&t.getY+t.height>=s);const n=t.getY;let r=!1,a=i.getNewBarYPosition(s);return i===t.parent?i.updateBarSvgLine(t,a):(e<0&&i.someBarOverflows(t,a)&&(a=i.getNextLineY(a)),t.parent.removeBarSvg(t),i.addBarSvg(t,a),r=!0),!(!r&&n===a)&&(t.setYPositionWithParent(i,a),!0)}checkTasksChanged(){const t=[];for(const e of Object.values(this.barSvgsMap||[]))t.includes(e.task.taskId)||(e.parentChanged()||e.progressChanged()||e.datesChanged())&&(this.gantt.onTaskChanged(gt(e.task)),t.push(e.task.taskId))}}class Et{constructor(t,e,s){this.fromBar=t,this.possibleToBars=e,this.gantt=s,this.listeners={},this.paths=[this.createDragPath(0,0)],this.arrowElements=[this.createElement(this.paths[0])],this.bindListeners(),this.initialOffsetX=t.endEndpointCX,this.initialOffsetY=t.endEndpointCY}createElement(t){return u("path",{d:t,class:"arrow"},this.gantt.layers.arrow)}bindListeners(){const t=this;this.listeners.drag=function(e){const s=S(e);t.onDrag(s.x,s.y)},this.gantt.svgContainer.addEventListener("mousemove",this.listeners.drag),this.gantt.svgContainer.addEventListener("touchmove",this.listeners.drag),setTimeout(()=>{t.listeners.click=function(e){t.onClick()},document.addEventListener("click",t.listeners.click)})}onClick(){this.selectedToBars&&this.selectedToBars.length&&this.gantt.createArrows(this.fromBars||[this.fromBar],this.selectedToBars),this.destroy(),this.gantt.destroyDragArrow()}onDrag(t,e){this.selectedToBars=this.findToBarByClientPosition(t,e),this.selectedToBars.length?(this.fromBars=this.gantt.linesSvg.getSameLockedBars(this.fromBar),this.paths=this.fromBars.reduce((t,e)=>(t.push(...this.selectedToBars.map(t=>St(e,t,this.gantt))),t),[])):(this.fromBars=null,this.paths=[this.createDragPath(t-this.initialOffsetX,e-this.initialOffsetY)]),this.updatePosition()}findToBarByClientPosition(t,e){const s=(this.possibleToBars||[]).find(s=>s.startX<=t&&s.endX>=t&&s.getY<=e&&s.getY+s.getHeight>=e);return s?this.possibleToBars.filter(t=>t.task.taskId===s.task.taskId):[]}createDragPath(t,e){const s=this.fromBar.endEndpointCX,i=this.fromBar.startEndpointCY;return`M ${s} ${i}\n                L ${s+t} ${i+e}`}updatePosition(){for(let t=0;t<this.paths.length;t++)this.arrowElements[t]?m(this.arrowElements[t],"d",this.paths[t]):this.arrowElements[t]=this.createElement(this.paths[t]);for(let t=this.paths.length;t<this.arrowElements.length;t++)m(this.arrowElements[t],"d","")}destroy(){this.paths=null,this.arrowElements&&this.arrowElements.forEach(t=>t.remove()),this.fromBar.onCreateArrowDestroyed(),this.removeListeners()}removeListeners(){this.listeners&&(this.gantt.svgContainer.removeEventListener("mousemove",this.listeners.drag),this.gantt.svgContainer.removeEventListener("touchmove",this.listeners.drag),document.removeEventListener("click",this.listeners.click))}}class xt{constructor(t,e,s,i){this.gantt=t,this.barsSvg=e,this.listeners={};const n=ct(t.settings,s);this.initialX=n.x,this.initialY=this.barsSvg.getNewBarYPosition(i),this.currentX=n.x,this.renderBar(),this.bindListeners()}get startX(){return Math.min(this.currentX,this.initialX)}get endX(){return Math.max(this.currentX,this.initialX)}renderBar(){const t=u("g",{class:"bar-wrapper disabled"},this.gantt.layers.bar),e=u("g",{class:"bar-group-wrapper"},t),s=u("g",{class:"bar-group"},e);this.barElement=u("rect",{x:this.initialX,y:this.initialY,width:0,height:this.gantt.options.barHeight,rx:this.gantt.options.barCornerRadius,ry:this.gantt.options.barCornerRadius,class:"bar"},s)}bindListeners(){const t=this;this.listeners.drag=function(e){t.onDrag(S(e).x)},this.gantt.svgContainer.addEventListener("mousemove",this.listeners.drag),this.gantt.svgContainer.addEventListener("touchmove",this.listeners.drag),setTimeout(()=>{t.listeners.click=function(e){t.onClick()},document.addEventListener("click",t.listeners.click)})}onDrag(t){const e=this.currentX,s=ct(this.gantt.settings,t);this.currentX=s.x,e!==this.currentX&&(this.updatePosition(),this.barsSvg.onNewBarDragging(this.startX,this.endX,this.initialY))}updatePosition(){const t=this.startX,e=this.endX;g(this.barElement,{x:t,width:e-t})}onClick(){this.destroy(),this.gantt.destroyDragBar(),this.startX!==this.endX&&this.gantt.createBar(this.barsSvg,this.startX,this.endX,this.initialY)}destroy(){this.barElement&&(this.barElement.remove(),this.barElement=null),this.barWrapperElement&&(this.barWrapperElement.remove(),this.barElement=null),this.removeListeners()}removeListeners(){this.listeners&&(this.gantt.svgContainer.removeEventListener("mousemove",this.listeners.drag),this.gantt.svgContainer.removeEventListener("touchmove",this.listeners.drag),document.removeEventListener("click",this.listeners.click))}}class Lt{constructor(t,e,s,i){this.master=i,this.layers={},this.options={},this.settings={},this.lines=[],this.setupWrapper(t),this.setupOptions(s),this.setupSwimLanes(e,this.options),this.setupAndRender(),this.bindListeners()}get tasks(){return Object.values(this.tasksMap||{})}get preventEventListeners(){return!!this.createDragArrowsSvg||!!this.createDragBarSvg}get containsSwimLanes(){return!!s(this.linesSvg)&&this.linesSvg.containsSwimLanes}setupWrapper(t){const{svgElement:e,wrapperElement:s}=function(t){let e,s,i;if(i="string"==typeof t?document.querySelector(t):t,i instanceof HTMLElement)s=i,e=i.querySelector("svg");else{if(!(i instanceof SVGElement))throw new TypeError("Frappé Gantt only supports usage of a string CSS selector, HTML DOM element or SVG DOM element for the 'element' parameter");e=i}return{svgElement:e,wrapperElement:s}}(t);e?(this.svgContainer=e,this.svgContainer.classList.add("gantt")):this.svgContainer=u("svg",{class:"gantt"},s),s.addEventListener("scroll",t=>console.log(1,t)),s.addEventListener("onscroll",t=>console.log(2,t)),this.swimlanesContainer=document.createElement("div"),this.swimlanesContainer.classList.add("gantt-swimlanes-container"),this.tasksContainer=document.createElement("div"),this.tasksContainer.classList.add("gantt-container");const i=this.svgContainer.parentElement;i.appendChild(this.swimlanesContainer),i.appendChild(this.tasksContainer),this.tasksContainer.appendChild(this.svgContainer)}setupOptions(t){this.options=Z(t),R(this.options.language)}setupSwimLanes(t,e){const{tasksMap:s,taskIdsMap:i}=at(t,e);this.tasksMap=s,this.taskIdsMap=i,this.lines=rt(Object.values(s),e)}scrollToToday(){this.scrollToDate(j(F(),12,L.Hour))}changeViewMode(t){t!==this.options.viewMode&&(this.options.viewMode=t,this.snapshotDate(),this.setupAndRender())}changeOptions(t){const e=Z(t);this.refreshGantt(this.tasks,e)}changeTasks(t,e){const s=e&&Z(e)||this.options;ut(this.tasks,t)?this.refreshGantt(t,s,!0):this.refreshGantt(this.tasks,s)}refreshGantt(t,e,s){var i,n;(s||(i=this.options,n=e,JSON.stringify(i)!==JSON.stringify(n)))&&(this.options=e,R(e.language),this.viewportWidthChangedALot(this.tasks,t,e)||this.snapshotDate(),this.setupSwimLanes(t,this.options),this.setupAndRender())}viewportWidthChangedALot(t,e,s){if(0===t.length&&e.length>0)return!0;if(!this.settings.minDate||!this.settings.maxDate)return!0;const i=at(e,s).tasksMap,{minDate:n,maxDate:r}=mt(Object.values(i),s),{value:a,scale:o}=et(s.viewMode),h=j(this.settings.minDate,-a,o),d=j(this.settings.minDate,a,o);return n.getTime()<h.getTime()||r.getTime()>d.getTime()}removeTask(t){const e=this.tasks.filter(e=>e.id!==t.id);this.refreshGantt(e,this.options,!0)}snapshotDate(){var t;const e=null===(t=this.svgContainer)||void 0===t?void 0:t.parentElement;if(!e)return;const s=(e.scrollLeft+e.clientWidth/2)/e.scrollWidth,i=(this.settings.maxDate.getTime()-this.settings.minDate.getTime())*s;this.scrollSnapshotDate=j(this.settings.minDate,i,L.Millisecond)}setupAndRender(){this.setupSettings(),this.render()}setupSettings(){this.setupRange(),this.setupDateValues(),this.setupDefaults()}setupRange(){const{minDate:t,maxDate:e}=mt(this.tasks,this.options);this.settings.minDate=t,this.settings.maxDate=e}setupDateValues(){this.settings.hoursStep=24*Q(this.options.viewMode),this.settings.dates=[this.settings.minDate];let t=this.settings.minDate;for(;t.getTime()<this.settings.maxDate.getTime();)t=tt(t,this.options.viewMode,this.settings.hoursStep),this.settings.dates.push(t);let e=0;this.settings.taskTicks=this.settings.dates.reduce((t,s)=>(t.push(...this.divideDateIntoTaskTicks(s,e)),e+=q(this.options,s),t),[])}divideDateIntoTaskTicks(t,e){const s=this.getTaskTicksDivider(t),i=q(this.options,t)/s,n=[];for(let r=0;r<s;r++)n.push({date:this.getTickDate(t,r),x:e+r*i});return n}getTaskTicksDivider(e){return this.options.viewMode===t.GanttMode.Week?7:this.options.viewMode===t.GanttMode.Year?12:this.options.viewMode===t.GanttMode.Month?I(e):1}getTickDate(e,s){if(0===s)return e;return j(e,s,this.options.viewMode===t.GanttMode.Year?L.Month:L.Day)}setupDefaults(){this.settings.numberRows=this.countNumberRows(),this.settings.headerHeight=this.options.headerHeight+this.options.padding,this.settings.rowHeights=[],this.settings.rowWidth=this.computeRowWidth(),this.settings.defaultRowHeight=this.options.barHeight+this.options.padding,this.settings.tableWidth=this.settings.rowWidth}computeRowWidth(){return this.settings.dates.reduce((t,e)=>t+q(this.options,e),0)}countNumberRows(){return(this.lines||[]).length}render(){this.clear(),this.setupLayers(),this.renderGridAndLines(),this.updateSize(),this.setScrollPosition()}clear(){this.svgContainer.innerHTML="",Object.values(this.layers||{}).forEach(t=>{var e;return null===(e=t)||void 0===e?void 0:e.remove()})}setupLayers(){this.layers={},this.layers.grid=u("g",{class:"grid"},this.svgContainer),this.layers.date=u("g",{class:"date"},this.svgContainer),this.layers.arrow=u("g",{class:"arrow"},this.svgContainer),this.layers.bar=u("g",{class:"bar"},this.svgContainer),this.layers.handle=u("g",{class:"handle"},this.svgContainer),this.layers.swimlanes=u("svg",{class:"gantt-swimlanes"},this.swimlanesContainer)}renderGridAndLines(){this.linesSvg=new bt(this),this.linesSvg.render(),this.gridSvg=new pt(this),this.gridSvg.render()}onLineResized(t,e){this.gridSvg.onLineResized(t,e),this.updateWrapperHeight()}updateWrapperHeight(){g(this.svgContainer,{height:st(this.settings)})}updateSize(){g(this.svgContainer,{width:"100%"});const t=this.svgContainer.getBoundingClientRect().width,e=this.settings.rowWidth,s={height:st(this.settings)};t<e&&(s.width=String(e)),g(this.svgContainer,s)}setScrollPosition(){if(this.scrollSnapshotDate)this.scrollToDate(this.scrollSnapshotDate),this.scrollSnapshotDate=null;else{const t=this.findFirstTaskInFuture();if(t)return void this.scrollToDate(t.startDate);const e=this.findFirstTaskInPast();if(e)return void this.scrollToDate(e.endDate);this.scrollToToday()}}findFirstTaskInFuture(){const t=z();let e=null;return this.tasks.forEach(s=>{!V(s.startDate,t)||e&&!$(s.startDate,e.startDate)||(e=s)}),e}findFirstTaskInPast(){const t=z();let e=null;return this.tasks.forEach(s=>{!$(s.endDate,t)||e&&!V(s.endDate,e.endDate)||(e=s)}),e}scrollToDate(t){var e;const s=null===(e=this.svgContainer)||void 0===e?void 0:e.parentElement;if(s){const e=s.scrollWidth/(this.settings.maxDate.getTime()-this.settings.minDate.getTime())*(t.getTime()-this.settings.minDate.getTime());s.scrollLeft=Math.max(0,e-s.clientWidth/2)}}onDragStart(t,e){var s,i,n;if((null===(s=e)||void 0===s?void 0:s.target)&&this.options.createTasks&&this.gridSvg.isTaskGridElement(e.target)){const t=S(e),s=this.linesSvg.findBarsSvgByY(t.y);s&&this.createDragBar(s,t.x,t.y)}else null===(i=this.linesSvg)||void 0===i||i.handleDragStart(t),null===(n=this.gridSvg)||void 0===n||n.handleDragStart(t)}onDrag(t,e,s,i,n){var r;null===(r=this.linesSvg)||void 0===r||r.handleDrag(t,e,s,i,n)}onDragEnd(t){var e,s;null===(e=this.linesSvg)||void 0===e||e.handleDragEnd(t),null===(s=this.gridSvg)||void 0===s||s.handleDragEnd(t)}onKeyUp(t){var e,s;"Escape"===t.key&&this.onEscapeKeyUp(),null===(e=this.linesSvg)||void 0===e||e.onKeyUp(t),null===(s=this.gridSvg)||void 0===s||s.onKeyUp(t),this.updateWrapperHeight()}onEscapeKeyUp(){this.createDragArrowsSvg&&(this.createDragArrowsSvg.destroy(),this.createDragArrowsSvg=null),this.createDragBarSvg&&(this.createDragBarSvg.destroy(),this.createDragBarSvg=null)}bindListeners(){document.addEventListener("mousedown",a),document.addEventListener("touchstart",a);const t=this;let e,s,i,n,r;function a(a){t.preventEventListeners||(document.addEventListener("mousemove",o),document.addEventListener("mouseup",h),document.addEventListener("mouseleave",h),document.addEventListener("touchmove",o),document.addEventListener("touchend",h),document.addEventListener("touchleave",h),document.addEventListener("touchcancel",h),e=n=a.clientX,s=r=a.clientY,i=a.target,t.onDragStart(i,a))}function o(a){if(a.preventDefault(),t.preventEventListeners)return;const o=a.clientX-n,h=a.clientY-r;n=a.clientX,r=a.clientY,t.onDrag(i,o,h,a.clientX-e,a.clientY-s)}function h(e){document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",h),document.removeEventListener("mouseleave",h),document.removeEventListener("touchmove",o),document.removeEventListener("touchend",h),document.removeEventListener("touchleave",h),document.removeEventListener("touchcancel",h),t.onDragEnd(i)}document.addEventListener("keyup",(function(e){t.onKeyUp(e),"Escape"===e.key&&h()})),document.addEventListener("dblclick",(function(e){t.onDoubleClick(e)}))}onDoubleClick(t){if(this.options.createTasks&&this.gridSvg.isTaskGridElement(t.target)){const e=S(t),s=this.linesSvg.findBarsSvgByY(e.y);s&&this.createDragBar(s,e.x,e.y)}else this.linesSvg.onDoubleClick(t.target)}createArrows(t,e){this.linesSvg.createArrows(t,e)}createDragArrow(t){if(!this.createDragArrowsSvg){const e=r(t.task.allowedDependencies,t.task.dependencies),s=r(e,t.task.parentDependencies),i=Object.values(this.linesSvg.barSvgsMap||{}).filter(t=>s.includes(t.task.id));this.createDragArrowsSvg=new Et(t,i,this)}}destroyDragArrow(){this.createDragArrowsSvg=null}createDragBar(t,e,s){this.createDragBarSvg||(this.createDragBarSvg=new xt(this,t,e,s),this.onDragStart(this.createDragBarSvg))}createBar(t,e,s,i){const n=this.createGanttTask(e,s);this.tasksMap[n.id]=n,this.taskIdsMap[n.id]=[n.id],t.createBarSvg(n,i)}createGanttTask(t,e){const s=J(this.options,this.settings,t),i=J(this.options,this.settings,e),n=U(s,this.options.dateFormat),r=U(i,this.options.dateFormat);return{id:nt("new"),taskId:null,name:"",startDate:s,endDate:i,start:n,end:r,editable:!1,parentDependencies:[],dependencies:[],allowedDependencies:[],parentTransitiveDependencies:[],transitiveDependencies:[],swimlanes:[],progress:null,endDrag:!1,startDrag:!1,progressDrag:!1}}destroyDragBar(){this.createDragBarSvg=null}onSwimlaneResized(t,e){this.master.onSwimlaneResized&&this.master.onSwimlaneResized(t,e)}onTaskChanged(t){this.master.onTaskChanged&&this.master.onTaskChanged(t)}onTaskDependencyAdded(t,e){this.master.onTaskDependencyAdded&&this.master.onTaskDependencyAdded(t,e)}onTaskDependencyRemoved(t,e){this.master.onTaskDependencyRemoved&&this.master.onTaskDependencyRemoved(t,e)}onTaskCreated(t){this.master.onTaskCreated&&this.master.onTaskCreated(t)}onTaskDoubleClick(t){this.master.onTaskDetail&&this.master.onTaskDetail(t)}}t.default=class{constructor(t,e,s){this.ganttSvg=new Lt(t,e,s,this)}scrollToToday(){this.ganttSvg.scrollToToday()}changeViewMode(t){this.ganttSvg.changeViewMode(t)}changeTasks(t,e){this.ganttSvg.changeTasks(t,e)}changeOptions(t){this.ganttSvg.changeOptions(t)}removeTask(t){this.ganttSvg.removeTask(t)}},Object.defineProperty(t,"__esModule",{value:!0})}));
